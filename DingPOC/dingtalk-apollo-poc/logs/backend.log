
> dingtalk-poc-backend@1.0.0 dev
> nodemon app.js

[33m[nodemon] 3.1.10[39m
[33m[nodemon] to restart at any time, enter `rs`[39m
[33m[nodemon] watching path(s): *.*[39m
[33m[nodemon] watching extensions: js,mjs,cjs,json[39m
[32m[nodemon] starting `node app.js`[39m
🚀 后端服务启动成功: http://localhost:8000
📋 健康检查: http://localhost:8000/health
✅ SQLite数据库连接成功
✅ 员工表创建/验证成功
✅ 同步日志表创建/验证成功
✅ 数据库初始化完成
::1 - - [01/Sep/2025:09:52:19 +0000] "GET /health HTTP/1.1" 200 94 "-" "curl/8.7.1"
GET /health - 200 - 6ms
::1 - - [01/Sep/2025:10:07:35 +0000] "GET /favicon.ico HTTP/1.1" 404 67 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /favicon.ico - 404 - 2ms
::1 - - [01/Sep/2025:10:07:35 +0000] "GET /api/employees HTTP/1.1" 200 2608 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 9ms
::1 - - [01/Sep/2025:10:07:35 +0000] "GET /api/employees HTTP/1.1" 200 2608 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 2ms
::1 - - [01/Sep/2025:10:07:56 +0000] "GET /favicon.ico HTTP/1.1" 404 67 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /favicon.ico - 404 - 2ms
::1 - - [01/Sep/2025:10:07:57 +0000] "GET /api/employees HTTP/1.1" 200 2608 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 3ms
::1 - - [01/Sep/2025:10:07:57 +0000] "GET /api/employees HTTP/1.1" 200 2608 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 3ms
🚀 开始员工数据同步...
🔑 更新钉钉API凭证...
✅ API凭证已更新
👥 获取在职员工列表...
🔑 获取钉钉Access Token...
⏳ 获取待入职员工列表...
🔑 获取钉钉Access Token...
🚪 获取离职员工列表...
🔑 获取钉钉Access Token...
✅ Access Token获取成功，有效期: 7200 秒
📞 调用待入职员工API，offset: 0
✅ Access Token获取成功，有效期: 7200 秒
📞 调用在职员工API，offset: 0
✅ Access Token获取成功，有效期: 7200 秒
📞 调用离职员工API，次标记 nextToken: 0
📦 共收集到离职用户 2 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📦 共收集到待入职用户 4 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📦 共收集到在职用户 3 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📝 解析员工数据 23565222083035276194: 23565222083035276194
📝 解析员工数据 024408350460583974855: 024408350460583974855
✅ 获取到 2 名离职员工
📝 解析员工数据 23565222091335276194: 23565222091335276194
📝 解析员工数据 manager918: manager918
📝 解析员工数据 66292386: 66292386
✅ 获取到 3 名在职员工
📝 解析员工数据 285154521324305418: 285154521324305418
📝 解析员工数据 180266290129328565: 180266290129328565
📝 解析员工数据 204635094835703839: 204635094835703839
📝 解析员工数据 230267420826317752: 230267420826317752
✅ 获取到 4 名待入职员工
📊 钉钉API数据获取完成: { active: 3, pending: 4, departed: 2 }
✅ 成功保存 9 条员工记录
🚀 开始导入数据到Apollo系统...
⚠️ Apollo数据库配置不完整，跳过实际导入
📤 模拟导入 9 条记录到Apollo系统
✅ 数据同步完成
::1 - - [01/Sep/2025:10:08:07 +0000] "POST /api/sync-employees HTTP/1.1" 200 1053 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
POST /api/sync-employees - 200 - 5422ms
⚠️ 慢查询警告: /api/sync-employees 耗时 5422ms
::1 - - [01/Sep/2025:10:08:07 +0000] "GET /api/employees HTTP/1.1" 200 2608 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 4ms
::1 - - [01/Sep/2025:10:09:32 +0000] "GET /main.83e3c989c3beb8575e73.hot-update.json HTTP/1.1" 404 97 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /main.83e3c989c3beb8575e73.hot-update.json - 404 - 4ms
::1 - - [01/Sep/2025:10:09:33 +0000] "GET /favicon.ico HTTP/1.1" 404 67 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /favicon.ico - 404 - 3ms
::1 - - [01/Sep/2025:10:09:33 +0000] "GET /api/employees HTTP/1.1" 200 2608 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 1ms
::1 - - [01/Sep/2025:10:09:33 +0000] "GET /api/employees HTTP/1.1" 200 2608 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 1ms
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node app.js`[39m
🚀 后端服务启动成功: http://localhost:8000
📋 健康检查: http://localhost:8000/health
✅ SQLite数据库连接成功
✅ 员工表创建/验证成功
✅ 同步日志表创建/验证成功
✅ 数据库初始化完成
::1 - - [01/Sep/2025:10:12:19 +0000] "GET /favicon.ico HTTP/1.1" 404 67 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /favicon.ico - 404 - 7ms
::1 - - [01/Sep/2025:10:12:19 +0000] "GET /api/employees HTTP/1.1" 200 2608 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 6ms
::1 - - [01/Sep/2025:10:12:19 +0000] "GET /api/employees HTTP/1.1" 200 2608 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 3ms
🚀 开始员工数据同步...
🔑 更新钉钉API凭证...
✅ API凭证已更新
👥 获取在职员工列表...
🔑 获取钉钉Access Token...
⏳ 获取待入职员工列表...
🔑 获取钉钉Access Token...
🚪 获取离职员工列表...
🔑 获取钉钉Access Token...
✅ Access Token获取成功，有效期: 7200 秒
📞 调用在职员工API，offset: 0
✅ Access Token获取成功，有效期: 7200 秒
📞 调用离职员工API，次标记 nextToken: 0
✅ Access Token获取成功，有效期: 7200 秒
📞 调用待入职员工API，offset: 0
📦 共收集到离职用户 2 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📦 共收集到在职用户 3 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📦 共收集到待入职用户 4 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📝 解析员工数据 23565222091335276194: 许测试 / 未知部门 (#MAYO Tset)
📝 解析员工数据 66292386: 张测试 / 未知部门 (#Buzz)
📝 解析员工数据 manager918: 许智宣 / 未知部门 (#Buzz)
✅ 获取到 3 名在职员工
📝 解析员工数据 23565222083035276194: 许测试 / 未知部门 (#0)
📝 解析员工数据 024408350460583974855: 小筑设计助手 / 未知部门 (#0)
✅ 获取到 2 名离职员工
📝 解析员工数据 285154521324305418: 张测试 / 未知部门 (#0)
📝 解析员工数据 180266290129328565: 王测试 / 未知部门 (#0)
📝 解析员工数据 204635094835703839: 赵测试 / 未知部门 (#0)
📝 解析员工数据 230267420826317752: 李测试 / 未知部门 (#0)
✅ 获取到 4 名待入职员工
📊 钉钉API数据获取完成: { active: 3, pending: 4, departed: 2 }
✅ 成功保存 9 条员工记录
🚀 开始导入数据到Apollo系统...
⚠️ Apollo数据库配置不完整，跳过实际导入
📤 模拟导入 9 条记录到Apollo系统
✅ 数据同步完成
::1 - - [01/Sep/2025:10:12:27 +0000] "POST /api/sync-employees HTTP/1.1" 200 992 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
POST /api/sync-employees - 200 - 5429ms
⚠️ 慢查询警告: /api/sync-employees 耗时 5429ms
::1 - - [01/Sep/2025:10:12:27 +0000] "GET /api/employees HTTP/1.1" 200 2756 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 4ms
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node app.js`[39m
🚀 后端服务启动成功: http://localhost:8000
📋 健康检查: http://localhost:8000/health
✅ SQLite数据库连接成功
✅ 员工表创建/验证成功
✅ 同步日志表创建/验证成功
✅ 数据库初始化完成
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node app.js`[39m
🚀 后端服务启动成功: http://localhost:8000
📋 健康检查: http://localhost:8000/health
✅ SQLite数据库连接成功
✅ 员工表创建/验证成功
✅ 同步日志表创建/验证成功
✅ 数据库初始化完成
::1 - - [01/Sep/2025:10:14:46 +0000] "GET /api/employees HTTP/1.1" 200 2756 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 31ms
::1 - - [01/Sep/2025:10:14:47 +0000] "GET /api/employees HTTP/1.1" 200 2756 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 1ms
::1 - - [01/Sep/2025:10:14:47 +0000] "GET /api/employees HTTP/1.1" 200 2756 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 1ms
🚀 开始员工数据同步...
🔑 更新钉钉API凭证...
✅ API凭证已更新
👥 获取在职员工列表...
🔑 获取钉钉Access Token...
⏳ 获取待入职员工列表...
🔑 获取钉钉Access Token...
🚪 获取离职员工列表...
🔑 获取钉钉Access Token...
✅ Access Token获取成功，有效期: 7200 秒
📞 调用在职员工API，offset: 0
✅ Access Token获取成功，有效期: 7200 秒
📞 调用离职员工API，次标记 nextToken: 0
✅ Access Token获取成功，有效期: 7200 秒
📞 调用待入职员工API，offset: 0
📦 共收集到离职用户 2 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📦 共收集到在职用户 3 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📦 共收集到待入职用户 4 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
🧩 有 2 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 23565222083035276194,024408350460583974855
🧩 有 3 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 23565222091335276194,manager918,66292386
🧯 仍有 2 个用户缺少部门ID，尝试通过用户详情API补充...
🔍 开始获取用户详情: 23565222083035276194
🔍 开始获取用户详情: 024408350460583974855
🧩 有 4 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 285154521324305418,180266290129328565,204635094835703839,230267420826317752
📋 用户详情API响应 23565222083035276194: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16lz3cxjuwim9"
}
❌ 获取用户详情失败 23565222083035276194: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 23565222091335276194: 许测试 / 未知部门 (#MAYO Tset)
📝 解析员工数据 manager918: 许智宣 / 未知部门 (#Buzz)
📝 解析员工数据 66292386: 张测试 / 未知部门 (#Buzz)
✅ 获取到 3 名在职员工
📋 用户详情API响应 024408350460583974855: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15s4m0gefqlxk"
}
❌ 获取用户详情失败 024408350460583974855: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 23565222083035276194: 许测试 / 未知部门 (#0)
📝 解析员工数据 024408350460583974855: 小筑设计助手 / 未知部门 (#0)
✅ 获取到 2 名离职员工
🧯 仍有 4 个用户缺少部门ID，尝试通过用户详情API补充...
🔍 开始获取用户详情: 285154521324305418
🔍 开始获取用户详情: 180266290129328565
🔍 开始获取用户详情: 204635094835703839
🔍 开始获取用户详情: 230267420826317752
📋 用户详情API响应 204635094835703839: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15qsdb869aimy"
}
❌ 获取用户详情失败 204635094835703839: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 230267420826317752: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16ml9k03sytp4"
}
❌ 获取用户详情失败 230267420826317752: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 285154521324305418: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16lleq070oer5"
}
❌ 获取用户详情失败 285154521324305418: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 180266290129328565: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16kgj1pv1496y"
}
❌ 获取用户详情失败 180266290129328565: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 285154521324305418: 张测试 / 未知部门 (#0)
📝 解析员工数据 180266290129328565: 王测试 / 未知部门 (#0)
📝 解析员工数据 204635094835703839: 赵测试 / 未知部门 (#0)
📝 解析员工数据 230267420826317752: 李测试 / 未知部门 (#0)
✅ 获取到 4 名待入职员工
📊 钉钉API数据获取完成: { active: 3, pending: 4, departed: 2 }
✅ 成功保存 9 条员工记录
🚀 开始导入数据到Apollo系统...
⚠️ Apollo数据库配置不完整，跳过实际导入
📤 模拟导入 9 条记录到Apollo系统
✅ 数据同步完成
::1 - - [01/Sep/2025:10:17:57 +0000] "POST /api/sync-employees HTTP/1.1" 200 992 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
POST /api/sync-employees - 200 - 7414ms
⚠️ 慢查询警告: /api/sync-employees 耗时 7414ms
::1 - - [01/Sep/2025:10:17:57 +0000] "GET /api/employees HTTP/1.1" 200 2831 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 3ms
::1 - - [01/Sep/2025:10:18:49 +0000] "GET /api/employees HTTP/1.1" 200 2831 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 4ms
::1 - - [01/Sep/2025:10:18:49 +0000] "GET /api/employees HTTP/1.1" 200 2831 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 2ms
🚀 开始员工数据同步...
🔑 更新钉钉API凭证...
✅ API凭证已更新
👥 获取在职员工列表...
🔑 获取钉钉Access Token...
⏳ 获取待入职员工列表...
🔑 获取钉钉Access Token...
🚪 获取离职员工列表...
🔑 获取钉钉Access Token...
✅ Access Token获取成功，有效期: 7200 秒
📞 调用离职员工API，次标记 nextToken: 0
✅ Access Token获取成功，有效期: 7200 秒
📞 调用在职员工API，offset: 0
✅ Access Token获取成功，有效期: 7200 秒
📞 调用待入职员工API，offset: 0
📦 共收集到离职用户 2 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📦 共收集到待入职用户 4 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📦 共收集到在职用户 3 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
🧩 有 2 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 23565222083035276194,024408350460583974855
🧩 有 3 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 23565222091335276194,66292386,manager918
🧩 有 4 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 285154521324305418,180266290129328565,204635094835703839,230267420826317752
🧯 仍有 2 个用户缺少部门ID，尝试通过用户详情API补充...
🔍 开始获取用户详情: 23565222083035276194
🔍 开始获取用户详情: 024408350460583974855
📝 解析员工数据 23565222091335276194: 许测试 / 未知部门 (#MAYO Tset)
📝 解析员工数据 66292386: 张测试 / 未知部门 (#Buzz)
📝 解析员工数据 manager918: 许智宣 / 未知部门 (#Buzz)
✅ 获取到 3 名在职员工
📋 用户详情API响应 23565222083035276194: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15qs72qj66toj"
}
❌ 获取用户详情失败 23565222083035276194: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 024408350460583974855: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15rydipwm2zsr"
}
❌ 获取用户详情失败 024408350460583974855: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 23565222083035276194: 许测试 / 未知部门 (#0)
📝 解析员工数据 024408350460583974855: 小筑设计助手 / 未知部门 (#0)
✅ 获取到 2 名离职员工
🧯 仍有 4 个用户缺少部门ID，尝试通过用户详情API补充...
🔍 开始获取用户详情: 285154521324305418
🔍 开始获取用户详情: 180266290129328565
🔍 开始获取用户详情: 204635094835703839
🔍 开始获取用户详情: 230267420826317752
📋 用户详情API响应 285154521324305418: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15r3720xuksqm"
}
❌ 获取用户详情失败 285154521324305418: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 230267420826317752: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16lwxerwzdpix"
}
❌ 获取用户详情失败 230267420826317752: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 180266290129328565: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16kwgr1x4cwz9"
}
❌ 获取用户详情失败 180266290129328565: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 204635094835703839: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15red9t33xgv0"
}
❌ 获取用户详情失败 204635094835703839: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 285154521324305418: 张测试 / 未知部门 (#0)
📝 解析员工数据 180266290129328565: 王测试 / 未知部门 (#0)
📝 解析员工数据 204635094835703839: 赵测试 / 未知部门 (#0)
📝 解析员工数据 230267420826317752: 李测试 / 未知部门 (#0)
✅ 获取到 4 名待入职员工
📊 钉钉API数据获取完成: { active: 3, pending: 4, departed: 2 }
✅ 成功保存 9 条员工记录
🚀 开始导入数据到Apollo系统...
⚠️ Apollo数据库配置不完整，跳过实际导入
📤 模拟导入 9 条记录到Apollo系统
✅ 数据同步完成
::1 - - [01/Sep/2025:10:21:25 +0000] "POST /api/sync-employees HTTP/1.1" 200 992 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
POST /api/sync-employees - 200 - 4707ms
::1 - - [01/Sep/2025:10:21:25 +0000] "GET /api/employees HTTP/1.1" 200 2831 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 3ms
🚀 开始员工数据同步...
🔑 更新钉钉API凭证...
✅ API凭证已更新
👥 获取在职员工列表...
🔑 获取钉钉Access Token...
⏳ 获取待入职员工列表...
🔑 获取钉钉Access Token...
🚪 获取离职员工列表...
🔑 获取钉钉Access Token...
✅ Access Token获取成功，有效期: 7200 秒
📞 调用在职员工API，offset: 0
✅ Access Token获取成功，有效期: 7200 秒
📞 调用离职员工API，次标记 nextToken: 0
✅ Access Token获取成功，有效期: 7200 秒
📞 调用待入职员工API，offset: 0
📦 共收集到离职用户 2 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📦 共收集到在职用户 3 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📦 共收集到待入职用户 4 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
🧩 有 3 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 23565222091335276194,66292386,manager918
🧩 有 2 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 23565222083035276194,024408350460583974855
🧩 有 4 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 285154521324305418,180266290129328565,204635094835703839,230267420826317752
📝 解析员工数据 23565222091335276194: 许测试 / 未知部门 (#MAYO Tset)
📝 解析员工数据 66292386: 张测试 / 未知部门 (#Buzz)
📝 解析员工数据 manager918: 许智宣 / 未知部门 (#Buzz)
✅ 获取到 3 名在职员工
🧯 仍有 2 个用户缺少部门ID，尝试通过用户详情API补充...
🔍 开始获取用户详情: 23565222083035276194
🔍 开始获取用户详情: 024408350460583974855
📋 用户详情API响应 23565222083035276194: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15qsjjq0p0k94"
}
❌ 获取用户详情失败 23565222083035276194: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 024408350460583974855: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16ki6aehicomj"
}
❌ 获取用户详情失败 024408350460583974855: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 23565222083035276194: 许测试 / 未知部门 (#0)
📝 解析员工数据 024408350460583974855: 小筑设计助手 / 未知部门 (#0)
✅ 获取到 2 名离职员工
🧯 仍有 4 个用户缺少部门ID，尝试通过用户详情API补充...
🔍 开始获取用户详情: 285154521324305418
🔍 开始获取用户详情: 180266290129328565
🔍 开始获取用户详情: 204635094835703839
🔍 开始获取用户详情: 230267420826317752
📋 用户详情API响应 285154521324305418: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16kuqe4jjalz1"
}
❌ 获取用户详情失败 285154521324305418: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 204635094835703839: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16kcsz4l55lr7"
}
❌ 获取用户详情失败 204635094835703839: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 180266290129328565: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16ki9encttehn"
}
❌ 获取用户详情失败 180266290129328565: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 230267420826317752: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15rs1wqgbgwj9"
}
❌ 获取用户详情失败 230267420826317752: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 285154521324305418: 张测试 / 未知部门 (#0)
📝 解析员工数据 180266290129328565: 王测试 / 未知部门 (#0)
📝 解析员工数据 204635094835703839: 赵测试 / 未知部门 (#0)
📝 解析员工数据 230267420826317752: 李测试 / 未知部门 (#0)
✅ 获取到 4 名待入职员工
📊 钉钉API数据获取完成: { active: 3, pending: 4, departed: 2 }
✅ 成功保存 9 条员工记录
🚀 开始导入数据到Apollo系统...
⚠️ Apollo数据库配置不完整，跳过实际导入
📤 模拟导入 9 条记录到Apollo系统
✅ 数据同步完成
::1 - - [01/Sep/2025:10:21:46 +0000] "POST /api/sync-employees HTTP/1.1" 200 992 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
POST /api/sync-employees - 200 - 5828ms
⚠️ 慢查询警告: /api/sync-employees 耗时 5828ms
::1 - - [01/Sep/2025:10:21:46 +0000] "GET /api/employees HTTP/1.1" 200 2831 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 2ms
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node app.js`[39m
🚀 后端服务启动成功: http://localhost:8000
📋 健康检查: http://localhost:8000/health
✅ SQLite数据库连接成功
✅ 员工表创建/验证成功
✅ 同步日志表创建/验证成功
✅ 数据库初始化完成
🚀 开始员工数据同步...
🔑 更新钉钉API凭证...
✅ API凭证已更新
👥 获取在职员工列表...
🔑 获取钉钉Access Token...
⏳ 获取待入职员工列表...
🔑 获取钉钉Access Token...
🚪 获取离职员工列表...
🔑 获取钉钉Access Token...
✅ Access Token获取成功，有效期: 7200 秒
📞 调用在职员工API，offset: 0
✅ Access Token获取成功，有效期: 7200 秒
📞 调用待入职员工API，offset: 0
✅ Access Token获取成功，有效期: 7200 秒
📞 调用离职员工API，次标记 nextToken: 0
📦 共收集到离职用户 2 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📦 共收集到在职用户 3 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📦 共收集到待入职用户 4 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
🧩 有 2 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 23565222083035276194,024408350460583974855
🧩 有 3 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 23565222091335276194,manager918,66292386
🧯 仍有 2 个用户缺少部门ID，尝试通过用户详情API补充...
🔍 开始获取用户详情: 23565222083035276194
🔍 开始获取用户详情: 024408350460583974855
🧩 有 4 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 285154521324305418,180266290129328565,204635094835703839,230267420826317752
📋 用户详情API响应 23565222083035276194: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15t86x21iroq1"
}
❌ 获取用户详情失败 23565222083035276194: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 23565222091335276194: 许测试 / 未知部门 (#MAYO Tset)
📝 解析员工数据 manager918: 许智宣 / 未知部门 (#Buzz)
📝 解析员工数据 66292386: 张测试 / 未知部门 (#Buzz)
✅ 获取到 3 名在职员工
📋 用户详情API响应 024408350460583974855: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15qzzox0vxav3"
}
❌ 获取用户详情失败 024408350460583974855: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 23565222083035276194: 许测试 / 未知部门 (#0)
📝 解析员工数据 024408350460583974855: 小筑设计助手 / 未知部门 (#0)
✅ 获取到 2 名离职员工
🧯 仍有 4 个用户缺少部门ID，尝试通过用户详情API补充...
🔍 开始获取用户详情: 285154521324305418
🔍 开始获取用户详情: 180266290129328565
🔍 开始获取用户详情: 204635094835703839
🔍 开始获取用户详情: 230267420826317752
📋 用户详情API响应 285154521324305418: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16kcpuvyjc9bh"
}
❌ 获取用户详情失败 285154521324305418: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 204635094835703839: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15rpvykylbobn"
}
❌ 获取用户详情失败 204635094835703839: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 180266290129328565: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16kk94blc8zgj"
}
❌ 获取用户详情失败 180266290129328565: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 230267420826317752: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16kxxr8y77xne"
}
❌ 获取用户详情失败 230267420826317752: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 285154521324305418: 张测试 / 未知部门 (#0)
📝 解析员工数据 180266290129328565: 王测试 / 未知部门 (#0)
📝 解析员工数据 204635094835703839: 赵测试 / 未知部门 (#0)
📝 解析员工数据 230267420826317752: 李测试 / 未知部门 (#0)
✅ 获取到 4 名待入职员工
📊 钉钉API数据获取完成: { active: 3, pending: 4, departed: 2 }
✅ 成功保存 9 条员工记录
🚀 开始导入数据到Apollo系统...
⚠️ Apollo数据库配置不完整，跳过实际导入
📤 模拟导入 9 条记录到Apollo系统
✅ 数据同步完成
::1 - - [01/Sep/2025:10:30:19 +0000] "POST /api/sync-employees HTTP/1.1" 200 992 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
POST /api/sync-employees - 200 - 8637ms
⚠️ 慢查询警告: /api/sync-employees 耗时 8637ms
::1 - - [01/Sep/2025:10:30:19 +0000] "GET /api/employees HTTP/1.1" 200 2901 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 6ms
🚀 开始员工数据同步...
🔑 更新钉钉API凭证...
✅ API凭证已更新
👥 获取在职员工列表...
🔑 获取钉钉Access Token...
⏳ 获取待入职员工列表...
🔑 获取钉钉Access Token...
🚪 获取离职员工列表...
🔑 获取钉钉Access Token...
✅ Access Token获取成功，有效期: 7200 秒
📞 调用离职员工API，次标记 nextToken: 0
✅ Access Token获取成功，有效期: 7200 秒
📞 调用待入职员工API，offset: 0
✅ Access Token获取成功，有效期: 7200 秒
📞 调用在职员工API，offset: 0
📦 共收集到离职用户 2 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📦 共收集到待入职用户 4 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📦 共收集到在职用户 3 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
🧩 有 2 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 23565222083035276194,024408350460583974855
🧩 有 3 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 23565222091335276194,66292386,manager918
🧩 有 4 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 285154521324305418,180266290129328565,204635094835703839,230267420826317752
🧯 仍有 2 个用户缺少部门ID，尝试通过用户详情API补充...
🔍 开始获取用户详情: 23565222083035276194
🔍 开始获取用户详情: 024408350460583974855
📝 解析员工数据 23565222091335276194: 许测试 / 未知部门 (#MAYO Tset)
📝 解析员工数据 66292386: 张测试 / 未知部门 (#Buzz)
📝 解析员工数据 manager918: 许智宣 / 未知部门 (#Buzz)
✅ 获取到 3 名在职员工
📋 用户详情API响应 23565222083035276194: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15rn7ay20dljp"
}
❌ 获取用户详情失败 23565222083035276194: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 024408350460583974855: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16mdqakv67i83"
}
❌ 获取用户详情失败 024408350460583974855: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 23565222083035276194: 许测试 / 未知部门 (#0)
📝 解析员工数据 024408350460583974855: 小筑设计助手 / 未知部门 (#0)
✅ 获取到 2 名离职员工
🧯 仍有 4 个用户缺少部门ID，尝试通过用户详情API补充...
🔍 开始获取用户详情: 285154521324305418
🔍 开始获取用户详情: 180266290129328565
🔍 开始获取用户详情: 204635094835703839
🔍 开始获取用户详情: 230267420826317752
📋 用户详情API响应 230267420826317752: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15rorfdpdoo3j"
}
❌ 获取用户详情失败 230267420826317752: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 204635094835703839: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15r1484deuvrh"
}
❌ 获取用户详情失败 204635094835703839: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 285154521324305418: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16mf46iry319f"
}
❌ 获取用户详情失败 285154521324305418: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 180266290129328565: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15rl7la27xsgr"
}
❌ 获取用户详情失败 180266290129328565: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 285154521324305418: 张测试 / 未知部门 (#0)
📝 解析员工数据 180266290129328565: 王测试 / 未知部门 (#0)
📝 解析员工数据 204635094835703839: 赵测试 / 未知部门 (#0)
📝 解析员工数据 230267420826317752: 李测试 / 未知部门 (#0)
✅ 获取到 4 名待入职员工
📊 钉钉API数据获取完成: { active: 3, pending: 4, departed: 2 }
✅ 成功保存 9 条员工记录
🚀 开始导入数据到Apollo系统...
⚠️ Apollo数据库配置不完整，跳过实际导入
📤 模拟导入 9 条记录到Apollo系统
✅ 数据同步完成
::1 - - [01/Sep/2025:10:31:56 +0000] "POST /api/sync-employees HTTP/1.1" 200 992 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
POST /api/sync-employees - 200 - 5558ms
⚠️ 慢查询警告: /api/sync-employees 耗时 5558ms
::1 - - [01/Sep/2025:10:31:56 +0000] "GET /api/employees HTTP/1.1" 200 2913 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 2ms
::1 - - [01/Sep/2025:10:37:04 +0000] "GET /favicon.ico HTTP/1.1" 404 67 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /favicon.ico - 404 - 1ms
::1 - - [01/Sep/2025:10:37:04 +0000] "GET /api/employees HTTP/1.1" 200 2913 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 2ms
::1 - - [01/Sep/2025:10:37:04 +0000] "GET /api/employees HTTP/1.1" 200 2913 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 2ms
::1 - - [01/Sep/2025:10:38:00 +0000] "GET /main.e159b50515ab7d8cef9e.hot-update.json HTTP/1.1" 404 97 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /main.e159b50515ab7d8cef9e.hot-update.json - 404 - 8ms
::1 - - [01/Sep/2025:10:38:00 +0000] "GET /favicon.ico HTTP/1.1" 404 67 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /favicon.ico - 404 - 12ms
::1 - - [01/Sep/2025:10:38:04 +0000] "GET /favicon.ico HTTP/1.1" 404 67 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /favicon.ico - 404 - 1ms
::1 - - [01/Sep/2025:10:38:09 +0000] "GET /favicon.ico HTTP/1.1" 404 67 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /favicon.ico - 404 - 1ms
::1 - - [01/Sep/2025:10:38:09 +0000] "GET /api/employees HTTP/1.1" 200 2913 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 39ms
::1 - - [01/Sep/2025:10:38:09 +0000] "GET /api/employees HTTP/1.1" 200 2913 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 5ms
::1 - - [01/Sep/2025:10:39:07 +0000] "GET /favicon.ico HTTP/1.1" 404 67 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /favicon.ico - 404 - 1ms
::1 - - [01/Sep/2025:10:39:10 +0000] "GET /favicon.ico HTTP/1.1" 404 67 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /favicon.ico - 404 - 1ms
::1 - - [01/Sep/2025:10:39:10 +0000] "GET /api/employees HTTP/1.1" 200 2913 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 4ms
::1 - - [01/Sep/2025:10:39:10 +0000] "GET /api/employees HTTP/1.1" 200 2913 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 2ms
::1 - - [01/Sep/2025:10:45:32 +0000] "GET /favicon.ico HTTP/1.1" 404 67 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /favicon.ico - 404 - 1ms
::1 - - [01/Sep/2025:10:45:32 +0000] "GET /api/employees HTTP/1.1" 200 2913 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 2ms
::1 - - [01/Sep/2025:10:45:32 +0000] "GET /api/employees HTTP/1.1" 200 2913 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 0ms
::1 - - [01/Sep/2025:11:00:20 +0000] "GET /favicon.ico HTTP/1.1" 404 67 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /favicon.ico - 404 - 2ms
::1 - - [01/Sep/2025:11:00:20 +0000] "GET /api/employees HTTP/1.1" 200 2913 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 9ms
::1 - - [01/Sep/2025:11:00:20 +0000] "GET /api/employees HTTP/1.1" 200 2913 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 1ms
🚀 开始员工数据同步...
🔑 更新钉钉API凭证...
✅ API凭证已更新
👥 获取在职员工列表...
🔑 获取钉钉Access Token...
⏳ 获取待入职员工列表...
🔑 获取钉钉Access Token...
🚪 获取离职员工列表...
🔑 获取钉钉Access Token...
✅ Access Token获取成功，有效期: 7200 秒
📞 调用待入职员工API，offset: 0
✅ Access Token获取成功，有效期: 7200 秒
📞 调用在职员工API，offset: 0
✅ Access Token获取成功，有效期: 7200 秒
📞 调用离职员工API，次标记 nextToken: 0
📦 共收集到离职用户 2 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📦 共收集到在职用户 3 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📦 共收集到待入职用户 4 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
🧩 有 2 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 23565222083035276194,024408350460583974855
🧩 有 3 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 23565222091335276194,manager918,66292386
🧯 仍有 2 个用户缺少部门ID，尝试通过用户详情API补充...
🔍 开始获取用户详情: 23565222083035276194
🔍 开始获取用户详情: 024408350460583974855
🧩 有 4 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 285154521324305418,180266290129328565,204635094835703839,230267420826317752
📋 用户详情API响应 23565222083035276194: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15rqbju6opaov"
}
❌ 获取用户详情失败 23565222083035276194: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 23565222091335276194: 许测试 / 未知部门 (#MAYO Tset)
📝 解析员工数据 manager918: 许智宣 / 未知部门 (#Buzz)
📝 解析员工数据 66292386: 张测试 / 未知部门 (#Buzz)
✅ 获取到 3 名在职员工
📋 用户详情API响应 024408350460583974855: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15r091oiezwv4"
}
❌ 获取用户详情失败 024408350460583974855: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 23565222083035276194: 许测试 / 未知部门 (#0)
📝 解析员工数据 024408350460583974855: 小筑设计助手 / 未知部门 (#0)
✅ 获取到 2 名离职员工
🧯 仍有 4 个用户缺少部门ID，尝试通过用户详情API补充...
🔍 开始获取用户详情: 285154521324305418
🔍 开始获取用户详情: 180266290129328565
🔍 开始获取用户详情: 204635094835703839
🔍 开始获取用户详情: 230267420826317752
📋 用户详情API响应 285154521324305418: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16lsuv86poc9k"
}
❌ 获取用户详情失败 285154521324305418: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 204635094835703839: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15qz4ih7kvp20"
}
❌ 获取用户详情失败 204635094835703839: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 180266290129328565: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16kkih32v1kyr"
}
❌ 获取用户详情失败 180266290129328565: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 230267420826317752: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16koes677iqgc"
}
❌ 获取用户详情失败 230267420826317752: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 285154521324305418: 张测试 / 未知部门 (#0)
📝 解析员工数据 180266290129328565: 王测试 / 未知部门 (#0)
📝 解析员工数据 204635094835703839: 赵测试 / 未知部门 (#0)
📝 解析员工数据 230267420826317752: 李测试 / 未知部门 (#0)
✅ 获取到 4 名待入职员工
📊 钉钉API数据获取完成: { active: 3, pending: 4, departed: 2 }
✅ 成功保存 9 条员工记录
🚀 开始导入数据到Apollo系统...
⚠️ Apollo数据库配置不完整，跳过实际导入
📤 模拟导入 9 条记录到Apollo系统
✅ 数据同步完成
::1 - - [01/Sep/2025:11:01:26 +0000] "POST /api/sync-employees HTTP/1.1" 200 992 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
POST /api/sync-employees - 200 - 5618ms
⚠️ 慢查询警告: /api/sync-employees 耗时 5618ms
::1 - - [01/Sep/2025:11:01:26 +0000] "GET /api/employees HTTP/1.1" 200 2913 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 1ms
::1 - - [01/Sep/2025:11:09:52 +0000] "GET /favicon.ico HTTP/1.1" 404 67 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /favicon.ico - 404 - 1ms
::1 - - [01/Sep/2025:11:09:52 +0000] "GET /api/employees HTTP/1.1" 200 2913 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 3ms
::1 - - [01/Sep/2025:11:09:52 +0000] "GET /api/employees HTTP/1.1" 200 2913 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 10ms
::1 - - [01/Sep/2025:11:11:00 +0000] "GET /favicon.ico HTTP/1.1" 404 67 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /favicon.ico - 404 - 2ms
::1 - - [01/Sep/2025:11:11:00 +0000] "GET /api/employees HTTP/1.1" 200 2913 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 6ms
::1 - - [01/Sep/2025:11:11:00 +0000] "GET /api/employees HTTP/1.1" 200 2913 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 4ms
🚀 开始员工数据同步...
🔑 更新钉钉API凭证...
✅ API凭证已更新
👥 获取在职员工列表...
🔑 获取钉钉Access Token...
⏳ 获取待入职员工列表...
🔑 获取钉钉Access Token...
🚪 获取离职员工列表...
🔑 获取钉钉Access Token...
✅ Access Token获取成功，有效期: 7200 秒
📞 调用待入职员工API，offset: 0
✅ Access Token获取成功，有效期: 7200 秒
📞 调用离职员工API，次标记 nextToken: 0
✅ Access Token获取成功，有效期: 7200 秒
📞 调用在职员工API，offset: 0
📦 共收集到离职用户 2 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📦 共收集到待入职用户 4 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📦 共收集到在职用户 3 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
🧩 有 2 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 23565222083035276194,024408350460583974855
🧩 有 3 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 23565222091335276194,manager918,66292386
🧯 仍有 2 个用户缺少部门ID，尝试通过用户详情API补充...
🔍 开始获取用户详情: 23565222083035276194
🔍 开始获取用户详情: 024408350460583974855
🧩 有 4 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 285154521324305418,180266290129328565,204635094835703839,230267420826317752
📝 解析员工数据 23565222091335276194: 许测试 / 未知部门 (#MAYO Tset)
📝 解析员工数据 manager918: 许智宣 / 未知部门 (#Buzz)
📝 解析员工数据 66292386: 张测试 / 未知部门 (#Buzz)
✅ 获取到 3 名在职员工
📋 用户详情API响应 23565222083035276194: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16l0vrnnrjfqn"
}
❌ 获取用户详情失败 23565222083035276194: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 024408350460583974855: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15s06zxkda6kc"
}
❌ 获取用户详情失败 024408350460583974855: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 23565222083035276194: 许测试 / 未知部门 (#0)
📝 解析员工数据 024408350460583974855: 小筑设计助手 / 未知部门 (#0)
✅ 获取到 2 名离职员工
🧯 仍有 4 个用户缺少部门ID，尝试通过用户详情API补充...
🔍 开始获取用户详情: 285154521324305418
🔍 开始获取用户详情: 180266290129328565
🔍 开始获取用户详情: 204635094835703839
🔍 开始获取用户详情: 230267420826317752
📋 用户详情API响应 230267420826317752: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15qyy9zqumk69"
}
❌ 获取用户详情失败 230267420826317752: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 204635094835703839: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15s2vnkikqowf"
}
❌ 获取用户详情失败 204635094835703839: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 180266290129328565: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16kya89kvsimn"
}
❌ 获取用户详情失败 180266290129328565: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 285154521324305418: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16koxhnouo26w"
}
❌ 获取用户详情失败 285154521324305418: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 285154521324305418: 张测试 / 未知部门 (#0)
📝 解析员工数据 180266290129328565: 王测试 / 未知部门 (#0)
📝 解析员工数据 204635094835703839: 赵测试 / 未知部门 (#0)
📝 解析员工数据 230267420826317752: 李测试 / 未知部门 (#0)
✅ 获取到 4 名待入职员工
📊 钉钉API数据获取完成: { active: 3, pending: 4, departed: 2 }
✅ 成功保存 9 条员工记录
🚀 开始导入数据到Apollo系统...
⚠️ Apollo数据库配置不完整，跳过实际导入
📤 模拟导入 9 条记录到Apollo系统
✅ 数据同步完成
::1 - - [01/Sep/2025:11:11:09 +0000] "POST /api/sync-employees HTTP/1.1" 200 992 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
POST /api/sync-employees - 200 - 5922ms
⚠️ 慢查询警告: /api/sync-employees 耗时 5922ms
::1 - - [01/Sep/2025:11:11:09 +0000] "GET /api/employees HTTP/1.1" 200 2920 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 2ms
::1 - - [01/Sep/2025:11:20:27 +0000] "GET /favicon.ico HTTP/1.1" 404 67 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /favicon.ico - 404 - 12ms
::1 - - [01/Sep/2025:11:20:28 +0000] "GET /api/employees HTTP/1.1" 200 2920 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 22ms
::1 - - [01/Sep/2025:11:20:28 +0000] "GET /api/employees HTTP/1.1" 200 2920 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 7ms
::1 - - [01/Sep/2025:11:22:11 +0000] "GET /favicon.ico HTTP/1.1" 404 67 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /favicon.ico - 404 - 14ms
::1 - - [01/Sep/2025:11:22:11 +0000] "GET /api/employees HTTP/1.1" 200 2920 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 9ms
::1 - - [01/Sep/2025:11:22:11 +0000] "GET /api/employees HTTP/1.1" 200 2920 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 3ms
::1 - - [01/Sep/2025:11:27:16 +0000] "GET /favicon.ico HTTP/1.1" 404 67 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /favicon.ico - 404 - 5ms
::1 - - [01/Sep/2025:11:27:16 +0000] "GET /api/employees HTTP/1.1" 200 2920 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 7ms
::1 - - [01/Sep/2025:11:27:16 +0000] "GET /api/employees HTTP/1.1" 200 2920 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 2ms
::1 - - [01/Sep/2025:11:29:37 +0000] "GET /favicon.ico HTTP/1.1" 404 67 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /favicon.ico - 404 - 1ms
::1 - - [01/Sep/2025:11:29:37 +0000] "GET /api/employees HTTP/1.1" 200 2920 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 2ms
::1 - - [01/Sep/2025:11:29:37 +0000] "GET /api/employees HTTP/1.1" 200 2920 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 1ms
🚀 开始员工数据同步...
🔑 更新钉钉API凭证...
✅ API凭证已更新
👥 获取在职员工列表...
🔑 获取钉钉Access Token...
⏳ 获取待入职员工列表...
🔑 获取钉钉Access Token...
🚪 获取离职员工列表...
🔑 获取钉钉Access Token...
✅ Access Token获取成功，有效期: 7200 秒
📞 调用待入职员工API，offset: 0
✅ Access Token获取成功，有效期: 7200 秒
📞 调用在职员工API，offset: 0
✅ Access Token获取成功，有效期: 7200 秒
📞 调用离职员工API，次标记 nextToken: 0
📦 共收集到离职用户 2 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📦 共收集到待入职用户 4 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📦 共收集到在职用户 3 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
🧩 有 2 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 23565222083035276194,024408350460583974855
🧩 有 3 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 23565222091335276194,66292386,manager918
🧯 仍有 2 个用户缺少部门ID，尝试通过用户详情API补充...
🔍 开始获取用户详情: 23565222083035276194
🔍 开始获取用户详情: 024408350460583974855
🧩 有 4 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 285154521324305418,180266290129328565,204635094835703839,230267420826317752
📋 用户详情API响应 23565222083035276194: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15rz5kznplbhx"
}
❌ 获取用户详情失败 23565222083035276194: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 23565222091335276194: 许测试 / 未知部门 (#MAYO Tset)
📝 解析员工数据 66292386: 张测试 / 未知部门 (#Buzz)
📝 解析员工数据 manager918: 许智宣 / 未知部门 (#Buzz)
✅ 获取到 3 名在职员工
📋 用户详情API响应 024408350460583974855: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16mbqkyi4eum4"
}
❌ 获取用户详情失败 024408350460583974855: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 23565222083035276194: 许测试 / 未知部门 (#0)
📝 解析员工数据 024408350460583974855: 小筑设计助手 / 未知部门 (#0)
✅ 获取到 2 名离职员工
🧯 仍有 4 个用户缺少部门ID，尝试通过用户详情API补充...
🔍 开始获取用户详情: 285154521324305418
🔍 开始获取用户详情: 180266290129328565
🔍 开始获取用户详情: 204635094835703839
🔍 开始获取用户详情: 230267420826317752
📋 用户详情API响应 204635094835703839: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16kg9p1a407g9"
}
❌ 获取用户详情失败 204635094835703839: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 230267420826317752: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16kx8tbo8pdbp"
}
❌ 获取用户详情失败 230267420826317752: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 180266290129328565: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15rj7vnp63f4o"
}
❌ 获取用户详情失败 180266290129328565: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 285154521324305418: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16m5buq67bash"
}
❌ 获取用户详情失败 285154521324305418: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 285154521324305418: 张测试 / 未知部门 (#0)
📝 解析员工数据 180266290129328565: 王测试 / 未知部门 (#0)
📝 解析员工数据 204635094835703839: 赵测试 / 未知部门 (#0)
📝 解析员工数据 230267420826317752: 李测试 / 未知部门 (#0)
✅ 获取到 4 名待入职员工
📊 钉钉API数据获取完成: { active: 3, pending: 4, departed: 2 }
✅ 成功保存 9 条员工记录
🚀 开始导入数据到Apollo系统...
⚠️ Apollo数据库配置不完整，跳过实际导入
📤 模拟导入 9 条记录到Apollo系统
✅ 数据同步完成
::1 - - [01/Sep/2025:11:29:47 +0000] "POST /api/sync-employees HTTP/1.1" 200 992 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
POST /api/sync-employees - 200 - 7554ms
⚠️ 慢查询警告: /api/sync-employees 耗时 7554ms
::1 - - [01/Sep/2025:11:29:47 +0000] "GET /api/employees HTTP/1.1" 200 2922 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 2ms
::1 - - [01/Sep/2025:11:30:08 +0000] "GET /favicon.ico HTTP/1.1" 404 67 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /favicon.ico - 404 - 2ms
::1 - - [01/Sep/2025:11:30:08 +0000] "GET /api/employees HTTP/1.1" 200 2922 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 3ms
::1 - - [01/Sep/2025:11:30:08 +0000] "GET /api/employees HTTP/1.1" 200 2922 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 1ms
::1 - - [01/Sep/2025:11:33:51 +0000] "GET /favicon.ico HTTP/1.1" 404 67 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /favicon.ico - 404 - 6ms
::1 - - [01/Sep/2025:11:33:51 +0000] "GET /api/employees HTTP/1.1" 200 2922 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 3ms
::1 - - [01/Sep/2025:11:33:51 +0000] "GET /api/employees HTTP/1.1" 200 2922 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 1ms
::1 - - [01/Sep/2025:11:33:58 +0000] "GET /favicon.ico HTTP/1.1" 404 67 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /favicon.ico - 404 - 1ms
::1 - - [01/Sep/2025:11:33:58 +0000] "GET /api/employees HTTP/1.1" 200 2922 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 3ms
::1 - - [01/Sep/2025:11:33:58 +0000] "GET /api/employees HTTP/1.1" 200 2922 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 3ms
::1 - - [01/Sep/2025:11:34:01 +0000] "GET /favicon.ico HTTP/1.1" 404 67 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /favicon.ico - 404 - 2ms
::1 - - [01/Sep/2025:11:34:01 +0000] "GET /api/employees HTTP/1.1" 200 2922 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 12ms
::1 - - [01/Sep/2025:11:34:01 +0000] "GET /api/employees HTTP/1.1" 200 2922 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 1ms
::1 - - [01/Sep/2025:11:34:04 +0000] "GET /api/employees HTTP/1.1" 200 2922 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 2ms
::1 - - [01/Sep/2025:11:38:30 +0000] "GET /favicon.ico HTTP/1.1" 404 67 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /favicon.ico - 404 - 2ms
::1 - - [01/Sep/2025:11:38:30 +0000] "GET /api/employees HTTP/1.1" 200 2922 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 14ms
::1 - - [01/Sep/2025:11:38:30 +0000] "GET /api/employees HTTP/1.1" 200 2922 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 4ms
::1 - - [01/Sep/2025:11:39:22 +0000] "GET /api/employees HTTP/1.1" 200 2922 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 7ms
🗑️ 开始清空员工数据...
✅ 员工数据已清空
::1 - - [01/Sep/2025:11:39:28 +0000] "DELETE /api/employees HTTP/1.1" 200 113 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
DELETE /api/employees - 200 - 6ms
🚀 开始员工数据同步...
🔑 更新钉钉API凭证...
✅ API凭证已更新
👥 获取在职员工列表...
🔑 获取钉钉Access Token...
⏳ 获取待入职员工列表...
🔑 获取钉钉Access Token...
🚪 获取离职员工列表...
🔑 获取钉钉Access Token...
✅ Access Token获取成功，有效期: 7200 秒
📞 调用在职员工API，offset: 0
✅ Access Token获取成功，有效期: 7200 秒
📞 调用待入职员工API，offset: 0
✅ Access Token获取成功，有效期: 7200 秒
📞 调用离职员工API，次标记 nextToken: 0
📦 共收集到离职用户 2 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📦 共收集到在职用户 3 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📦 共收集到待入职用户 4 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
🧩 有 2 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 23565222083035276194,024408350460583974855
🧩 有 3 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 23565222091335276194,manager918,66292386
🧯 仍有 2 个用户缺少部门ID，尝试通过用户详情API补充...
🔍 开始获取用户详情: 23565222083035276194
🔍 开始获取用户详情: 024408350460583974855
🧩 有 4 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 285154521324305418,180266290129328565,204635094835703839,230267420826317752
📝 解析员工数据 23565222091335276194: 许测试 / 未知部门 (#MAYO Tset)
📝 解析员工数据 manager918: 许智宣 / 未知部门 (#Buzz)
📝 解析员工数据 66292386: 张测试 / 未知部门 (#Buzz)
✅ 获取到 3 名在职员工
📋 用户详情API响应 23565222083035276194: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15s6fhoyo7bem"
}
❌ 获取用户详情失败 23565222083035276194: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 024408350460583974855: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16lrgzbcrqs5l"
}
❌ 获取用户详情失败 024408350460583974855: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 23565222083035276194: 许测试 / 未知部门 (#0)
📝 解析员工数据 024408350460583974855: 小筑设计助手 / 未知部门 (#0)
✅ 获取到 2 名离职员工
🧯 仍有 4 个用户缺少部门ID，尝试通过用户详情API补充...
🔍 开始获取用户详情: 285154521324305418
🔍 开始获取用户详情: 180266290129328565
🔍 开始获取用户详情: 204635094835703839
🔍 开始获取用户详情: 230267420826317752
📋 用户详情API响应 285154521324305418: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16kfx822yjzuf"
}
❌ 获取用户详情失败 285154521324305418: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 204635094835703839: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16kiciyf9imf6"
}
❌ 获取用户详情失败 204635094835703839: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 180266290129328565: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16mdn6dwpkhvl"
}
❌ 获取用户详情失败 180266290129328565: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 230267420826317752: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15rvce5oq5c6p"
}
❌ 获取用户详情失败 230267420826317752: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 285154521324305418: 张测试 / 未知部门 (#0)
📝 解析员工数据 180266290129328565: 王测试 / 未知部门 (#0)
📝 解析员工数据 204635094835703839: 赵测试 / 未知部门 (#0)
📝 解析员工数据 230267420826317752: 李测试 / 未知部门 (#0)
✅ 获取到 4 名待入职员工
📊 钉钉API数据获取完成: { active: 3, pending: 4, departed: 2 }
✅ 成功保存 9 条员工记录
🚀 开始导入数据到Apollo系统...
⚠️ Apollo数据库配置不完整，跳过实际导入
📤 模拟导入 9 条记录到Apollo系统
✅ 数据同步完成
::1 - - [01/Sep/2025:11:39:39 +0000] "POST /api/sync-employees HTTP/1.1" 200 992 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
POST /api/sync-employees - 200 - 5690ms
⚠️ 慢查询警告: /api/sync-employees 耗时 5690ms
::1 - - [01/Sep/2025:11:39:39 +0000] "GET /api/employees HTTP/1.1" 200 2922 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 2ms
🗑️ 开始清空员工数据...
✅ 员工数据已清空
::1 - - [01/Sep/2025:11:43:07 +0000] "DELETE /api/employees HTTP/1.1" 200 113 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
DELETE /api/employees - 200 - 3ms
🚀 开始员工数据同步...
🔑 更新钉钉API凭证...
✅ API凭证已更新
👥 获取在职员工列表...
🔑 获取钉钉Access Token...
⏳ 获取待入职员工列表...
🔑 获取钉钉Access Token...
🚪 获取离职员工列表...
🔑 获取钉钉Access Token...
✅ Access Token获取成功，有效期: 7200 秒
📞 调用在职员工API，offset: 0
✅ Access Token获取成功，有效期: 7200 秒
📞 调用待入职员工API，offset: 0
✅ Access Token获取成功，有效期: 7200 秒
📞 调用离职员工API，次标记 nextToken: 0
📦 共收集到离职用户 2 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📦 共收集到在职用户 3 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📦 共收集到待入职用户 4 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
🧩 有 3 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 23565222091335276194,manager918,66292386
🧩 有 2 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 23565222083035276194,024408350460583974855
🧩 有 4 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 285154521324305418,180266290129328565,204635094835703839,230267420826317752
📝 解析员工数据 23565222091335276194: 许测试 / 未知部门 (#MAYO Tset)
📝 解析员工数据 manager918: 许智宣 / 未知部门 (#Buzz)
📝 解析员工数据 66292386: 张测试 / 未知部门 (#Buzz)
✅ 获取到 3 名在职员工
🧯 仍有 2 个用户缺少部门ID，尝试通过用户详情API补充...
🔍 开始获取用户详情: 23565222083035276194
🔍 开始获取用户详情: 024408350460583974855
📋 用户详情API响应 024408350460583974855: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16lpkdwbvy4ut"
}
❌ 获取用户详情失败 024408350460583974855: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 23565222083035276194: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15s8uslemcofx"
}
❌ 获取用户详情失败 23565222083035276194: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 23565222083035276194: 许测试 / 未知部门 (#0)
📝 解析员工数据 024408350460583974855: 小筑设计助手 / 未知部门 (#0)
✅ 获取到 2 名离职员工
🧯 仍有 4 个用户缺少部门ID，尝试通过用户详情API补充...
🔍 开始获取用户详情: 285154521324305418
🔍 开始获取用户详情: 180266290129328565
🔍 开始获取用户详情: 204635094835703839
🔍 开始获取用户详情: 230267420826317752
📋 用户详情API响应 180266290129328565: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16mfaf2izoazd"
}
❌ 获取用户详情失败 180266290129328565: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 204635094835703839: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15qx1olixa784"
}
❌ 获取用户详情失败 204635094835703839: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 285154521324305418: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16mm1mac4hhy7"
}
❌ 获取用户详情失败 285154521324305418: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 230267420826317752: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16le1p4pgnc5y"
}
❌ 获取用户详情失败 230267420826317752: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 285154521324305418: 张测试 / 未知部门 (#0)
📝 解析员工数据 180266290129328565: 王测试 / 未知部门 (#0)
📝 解析员工数据 204635094835703839: 赵测试 / 未知部门 (#0)
📝 解析员工数据 230267420826317752: 李测试 / 未知部门 (#0)
✅ 获取到 4 名待入职员工
📊 钉钉API数据获取完成: { active: 3, pending: 4, departed: 2 }
✅ 成功保存 9 条员工记录
🚀 开始导入数据到Apollo系统...
⚠️ Apollo数据库配置不完整，跳过实际导入
📤 模拟导入 9 条记录到Apollo系统
✅ 数据同步完成
::1 - - [01/Sep/2025:11:43:13 +0000] "POST /api/sync-employees HTTP/1.1" 200 992 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
POST /api/sync-employees - 200 - 4282ms
::1 - - [01/Sep/2025:11:43:13 +0000] "GET /api/employees HTTP/1.1" 200 2922 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 2ms
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node app.js`[39m
🚀 后端服务启动成功: http://localhost:8000
📋 健康检查: http://localhost:8000/health
✅ SQLite数据库连接成功
✅ 员工表创建/验证成功
✅ 同步日志表创建/验证成功
✅ 数据库初始化完成
::1 - - [02/Sep/2025:02:39:11 +0000] "GET /favicon.ico HTTP/1.1" 404 67 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /favicon.ico - 404 - 9ms
::1 - - [02/Sep/2025:02:39:11 +0000] "GET /api/employees HTTP/1.1" 200 2922 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 11ms
::1 - - [02/Sep/2025:02:39:11 +0000] "GET /api/employees HTTP/1.1" 200 2922 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 8ms
🗑️ 开始清空员工数据...
✅ 员工数据已清空
::1 - - [02/Sep/2025:02:39:21 +0000] "DELETE /api/employees HTTP/1.1" 200 113 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
DELETE /api/employees - 200 - 11ms
🚀 开始员工数据同步...
🔑 更新钉钉API凭证...
✅ API凭证已更新
👥 获取在职员工列表...
🔑 获取钉钉Access Token...
⏳ 获取待入职员工列表...
🔑 获取钉钉Access Token...
🚪 获取离职员工列表...
🔑 获取钉钉Access Token...
✅ Access Token获取成功，有效期: 7200 秒
📞 调用在职员工API，offset: 0
✅ Access Token获取成功，有效期: 7200 秒
📞 调用离职员工API，次标记 nextToken: 0
✅ Access Token获取成功，有效期: 7200 秒
📞 调用待入职员工API，offset: 0
📦 共收集到离职用户 2 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📦 共收集到待入职用户 4 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📦 共收集到在职用户 3 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
🧩 有 2 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 23565222083035276194,024408350460583974855
🧩 有 3 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 23565222091335276194,manager918,66292386
🧩 有 4 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 285154521324305418,180266290129328565,204635094835703839,230267420826317752
🧯 仍有 2 个用户缺少部门ID，尝试通过用户详情API补充...
🔍 开始获取用户详情: 23565222083035276194
🔍 开始获取用户详情: 024408350460583974855
📝 解析员工数据 23565222091335276194: 许测试 / 未知部门 (#MAYO Tset)
📝 解析员工数据 manager918: 许智宣 / 未知部门 (#Buzz)
📝 解析员工数据 66292386: 张测试 / 未知部门 (#Buzz)
✅ 获取到 3 名在职员工
📋 用户详情API响应 23565222083035276194: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15rsnr84v4kfr"
}
❌ 获取用户详情失败 23565222083035276194: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 024408350460583974855: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16kr3gjmjz328"
}
❌ 获取用户详情失败 024408350460583974855: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 23565222083035276194: 许测试 / 未知部门 (#0)
📝 解析员工数据 024408350460583974855: 小筑设计助手 / 未知部门 (#0)
✅ 获取到 2 名离职员工
🧯 仍有 4 个用户缺少部门ID，尝试通过用户详情API补充...
🔍 开始获取用户详情: 285154521324305418
🔍 开始获取用户详情: 180266290129328565
🔍 开始获取用户详情: 204635094835703839
🔍 开始获取用户详情: 230267420826317752
📋 用户详情API响应 285154521324305418: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16lhoo6imh77p"
}
❌ 获取用户详情失败 285154521324305418: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 180266290129328565: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16lzfuoqf9tu7"
}
❌ 获取用户详情失败 180266290129328565: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 204635094835703839: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16kqqzk5dxc78"
}
❌ 获取用户详情失败 204635094835703839: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 230267420826317752: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16lsrrpsl5aoi"
}
❌ 获取用户详情失败 230267420826317752: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 285154521324305418: 张测试 / 未知部门 (#0)
📝 解析员工数据 180266290129328565: 王测试 / 未知部门 (#0)
📝 解析员工数据 204635094835703839: 赵测试 / 未知部门 (#0)
📝 解析员工数据 230267420826317752: 李测试 / 未知部门 (#0)
✅ 获取到 4 名待入职员工
📊 钉钉API数据获取完成: { active: 3, pending: 4, departed: 2 }
✅ 成功保存 9 条员工记录
🚀 开始导入数据到Apollo系统...
⚠️ Apollo数据库配置不完整，跳过实际导入
📤 模拟导入 9 条记录到Apollo系统
✅ 数据同步完成
::1 - - [02/Sep/2025:02:39:30 +0000] "POST /api/sync-employees HTTP/1.1" 200 992 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
POST /api/sync-employees - 200 - 7098ms
⚠️ 慢查询警告: /api/sync-employees 耗时 7098ms
::1 - - [02/Sep/2025:02:39:30 +0000] "GET /api/employees HTTP/1.1" 200 2922 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 1ms
🚀 开始员工数据同步...
🔑 更新钉钉API凭证...
✅ API凭证已更新
👥 获取在职员工列表...
🔑 获取钉钉Access Token...
⏳ 获取待入职员工列表...
🔑 获取钉钉Access Token...
🚪 获取离职员工列表...
🔑 获取钉钉Access Token...
✅ Access Token获取成功，有效期: 7200 秒
📞 调用待入职员工API，offset: 0
✅ Access Token获取成功，有效期: 7200 秒
📞 调用在职员工API，offset: 0
✅ Access Token获取成功，有效期: 7200 秒
📞 调用离职员工API，次标记 nextToken: 0
📦 共收集到离职用户 2 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📦 共收集到待入职用户 4 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📦 共收集到在职用户 3 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
🧩 有 3 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 23565222091335276194,manager918,66292386
🧩 有 4 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 285154521324305418,180266290129328565,204635094835703839,230267420826317752
🧩 有 2 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 23565222083035276194,024408350460583974855
📝 解析员工数据 23565222091335276194: 许测试 / 未知部门 (#MAYO Tset)
📝 解析员工数据 manager918: 许智宣 / 未知部门 (#Buzz)
📝 解析员工数据 66292386: 张测试 / 未知部门 (#Buzz)
✅ 获取到 3 名在职员工
🧯 仍有 2 个用户缺少部门ID，尝试通过用户详情API补充...
🔍 开始获取用户详情: 23565222083035276194
🔍 开始获取用户详情: 024408350460583974855
📋 用户详情API响应 23565222083035276194: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15s82r2woy9fh"
}
❌ 获取用户详情失败 23565222083035276194: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 024408350460583974855: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16lkjkb8fdkbh"
}
❌ 获取用户详情失败 024408350460583974855: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 23565222083035276194: 许测试 / 未知部门 (#0)
📝 解析员工数据 024408350460583974855: 小筑设计助手 / 未知部门 (#0)
✅ 获取到 2 名离职员工
🧯 仍有 4 个用户缺少部门ID，尝试通过用户详情API补充...
🔍 开始获取用户详情: 285154521324305418
🔍 开始获取用户详情: 180266290129328565
🔍 开始获取用户详情: 204635094835703839
🔍 开始获取用户详情: 230267420826317752
📋 用户详情API响应 285154521324305418: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15rx2rsi1vzcb"
}
❌ 获取用户详情失败 285154521324305418: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 204635094835703839: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16kjzscdal1e6"
}
❌ 获取用户详情失败 204635094835703839: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 180266290129328565: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15s0d95jbmcdk"
}
❌ 获取用户详情失败 180266290129328565: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 230267420826317752: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16merqamyntle"
}
❌ 获取用户详情失败 230267420826317752: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 285154521324305418: 张测试 / 未知部门 (#0)
📝 解析员工数据 180266290129328565: 王测试 / 未知部门 (#0)
📝 解析员工数据 204635094835703839: 赵测试 / 未知部门 (#0)
📝 解析员工数据 230267420826317752: 李测试 / 未知部门 (#0)
✅ 获取到 4 名待入职员工
📊 钉钉API数据获取完成: { active: 3, pending: 4, departed: 2 }
✅ 成功保存 9 条员工记录
🚀 开始导入数据到Apollo系统...
⚠️ Apollo数据库配置不完整，跳过实际导入
📤 模拟导入 9 条记录到Apollo系统
✅ 数据同步完成
::1 - - [02/Sep/2025:02:40:32 +0000] "POST /api/sync-employees HTTP/1.1" 200 992 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
POST /api/sync-employees - 200 - 4960ms
::1 - - [02/Sep/2025:02:40:32 +0000] "GET /api/employees HTTP/1.1" 200 2940 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 2ms
🗑️ 开始清空员工数据...
✅ 员工数据已清空
::1 - - [02/Sep/2025:02:48:23 +0000] "DELETE /api/employees HTTP/1.1" 200 113 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
DELETE /api/employees - 200 - 21ms
🚀 开始员工数据同步...
🔑 更新钉钉API凭证...
✅ API凭证已更新
👥 获取在职员工列表...
🔑 获取钉钉Access Token...
⏳ 获取待入职员工列表...
🔑 获取钉钉Access Token...
🚪 获取离职员工列表...
🔑 获取钉钉Access Token...
✅ Access Token获取成功，有效期: 7200 秒
📞 调用在职员工API，offset: 0
✅ Access Token获取成功，有效期: 7200 秒
📞 调用待入职员工API，offset: 0
✅ Access Token获取成功，有效期: 7200 秒
📞 调用离职员工API，次标记 nextToken: 0
📦 共收集到离职用户 2 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📦 共收集到待入职用户 4 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📦 共收集到在职用户 3 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
🧩 有 2 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 23565222083035276194,024408350460583974855
🧩 有 3 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 23565222091335276194,manager918,66292386
🧯 仍有 2 个用户缺少部门ID，尝试通过用户详情API补充...
🔍 开始获取用户详情: 23565222083035276194
🔍 开始获取用户详情: 024408350460583974855
🧩 有 4 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 285154521324305418,180266290129328565,204635094835703839,230267420826317752
📋 用户详情API响应 23565222083035276194: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16lleqs5jobc3"
}
❌ 获取用户详情失败 23565222083035276194: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 23565222091335276194: 许测试 / 未知部门 (#MAYO Tset)
📝 解析员工数据 manager918: 许智宣 / 未知部门 (#Buzz)
📝 解析员工数据 66292386: 张测试 / 未知部门 (#Buzz)
✅ 获取到 3 名在职员工
📋 用户详情API响应 024408350460583974855: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16lxj99v2jgx5"
}
❌ 获取用户详情失败 024408350460583974855: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 23565222083035276194: 许测试 / 未知部门 (#0)
📝 解析员工数据 024408350460583974855: 小筑设计助手 / 未知部门 (#0)
✅ 获取到 2 名离职员工
🧯 仍有 4 个用户缺少部门ID，尝试通过用户详情API补充...
🔍 开始获取用户详情: 285154521324305418
🔍 开始获取用户详情: 180266290129328565
🔍 开始获取用户详情: 204635094835703839
🔍 开始获取用户详情: 230267420826317752
📋 用户详情API响应 180266290129328565: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15r50jz23scxd"
}
❌ 获取用户详情失败 180266290129328565: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 285154521324305418: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15rfo29zl29hm"
}
❌ 获取用户详情失败 285154521324305418: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 204635094835703839: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15rr6r1m143yy"
}
❌ 获取用户详情失败 204635094835703839: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 230267420826317752: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16m7kxuphndj3"
}
❌ 获取用户详情失败 230267420826317752: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 285154521324305418: 张测试 / 未知部门 (#0)
📝 解析员工数据 180266290129328565: 王测试 / 未知部门 (#0)
📝 解析员工数据 204635094835703839: 赵测试 / 未知部门 (#0)
📝 解析员工数据 230267420826317752: 李测试 / 未知部门 (#0)
✅ 获取到 4 名待入职员工
📊 钉钉API数据获取完成: { active: 3, pending: 4, departed: 2 }
✅ 成功保存 9 条员工记录
🚀 开始导入数据到Apollo系统...
⚠️ Apollo数据库配置不完整，跳过实际导入
📤 模拟导入 9 条记录到Apollo系统
✅ 数据同步完成
::1 - - [02/Sep/2025:02:48:33 +0000] "POST /api/sync-employees HTTP/1.1" 200 992 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
POST /api/sync-employees - 200 - 6499ms
⚠️ 慢查询警告: /api/sync-employees 耗时 6499ms
::1 - - [02/Sep/2025:02:48:33 +0000] "GET /api/employees HTTP/1.1" 200 2940 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 5ms
::1 - - [02/Sep/2025:06:02:40 +0000] "GET /favicon.ico HTTP/1.1" 404 67 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /favicon.ico - 404 - 44ms
::1 - - [02/Sep/2025:06:02:41 +0000] "GET /api/employees HTTP/1.1" 200 2940 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 11ms
::1 - - [02/Sep/2025:06:02:41 +0000] "GET /api/employees HTTP/1.1" 200 2940 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 2ms
🗑️ 开始清空员工数据...
✅ 员工数据已清空
::1 - - [02/Sep/2025:06:02:43 +0000] "DELETE /api/employees HTTP/1.1" 200 113 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
DELETE /api/employees - 200 - 5ms
🚀 开始员工数据同步...
🔑 更新钉钉API凭证...
✅ API凭证已更新
👥 获取在职员工列表...
🔑 获取钉钉Access Token...
⏳ 获取待入职员工列表...
🔑 获取钉钉Access Token...
🚪 获取离职员工列表...
🔑 获取钉钉Access Token...
✅ Access Token获取成功，有效期: 7200 秒
📞 调用离职员工API，次标记 nextToken: 0
✅ Access Token获取成功，有效期: 7200 秒
📞 调用在职员工API，offset: 0
✅ Access Token获取成功，有效期: 7200 秒
📞 调用待入职员工API，offset: 0
📦 共收集到离职用户 2 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📦 共收集到待入职用户 4 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📦 共收集到在职用户 3 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
🧩 有 2 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 23565222083035276194,024408350460583974855
🧩 有 3 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 23565222091335276194,66292386,manager918
🧯 仍有 2 个用户缺少部门ID，尝试通过用户详情API补充...
🔍 开始获取用户详情: 23565222083035276194
🔍 开始获取用户详情: 024408350460583974855
🧩 有 4 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 285154521324305418,180266290129328565,204635094835703839,230267420826317752
📋 用户详情API响应 23565222083035276194: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16mb4s3u1jxw4"
}
❌ 获取用户详情失败 23565222083035276194: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 23565222091335276194: 许测试 / 未知部门 (#MAYO Tset)
📝 解析员工数据 66292386: 张测试 / 未知部门 (#Buzz)
📝 解析员工数据 manager918: 许智宣 / 未知部门 (#Buzz)
✅ 获取到 3 名在职员工
📋 用户详情API响应 024408350460583974855: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16m91y6yxdxnj"
}
❌ 获取用户详情失败 024408350460583974855: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 23565222083035276194: 许测试 / 未知部门 (#0)
📝 解析员工数据 024408350460583974855: 小筑设计助手 / 未知部门 (#0)
✅ 获取到 2 名离职员工
🧯 仍有 4 个用户缺少部门ID，尝试通过用户详情API补充...
🔍 开始获取用户详情: 285154521324305418
🔍 开始获取用户详情: 180266290129328565
🔍 开始获取用户详情: 204635094835703839
🔍 开始获取用户详情: 230267420826317752
📋 用户详情API响应 285154521324305418: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15qt8imb6lp1f"
}
❌ 获取用户详情失败 285154521324305418: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 180266290129328565: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15rgj8w5yq5j0"
}
❌ 获取用户详情失败 180266290129328565: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 204635094835703839: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15r3mo6mruu2w"
}
❌ 获取用户详情失败 204635094835703839: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 230267420826317752: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15s4s9vl0b2l4"
}
❌ 获取用户详情失败 230267420826317752: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 285154521324305418: 张测试 / 未知部门 (#0)
📝 解析员工数据 180266290129328565: 王测试 / 未知部门 (#0)
📝 解析员工数据 204635094835703839: 赵测试 / 未知部门 (#0)
📝 解析员工数据 230267420826317752: 李测试 / 未知部门 (#0)
✅ 获取到 4 名待入职员工
📊 钉钉API数据获取完成: { active: 3, pending: 4, departed: 2 }
✅ 成功保存 9 条员工记录
🚀 开始导入数据到Apollo系统...
⚠️ Apollo数据库配置不完整，跳过实际导入
📤 模拟导入 9 条记录到Apollo系统
✅ 数据同步完成
::1 - - [02/Sep/2025:06:02:51 +0000] "POST /api/sync-employees HTTP/1.1" 200 992 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
POST /api/sync-employees - 200 - 6758ms
⚠️ 慢查询警告: /api/sync-employees 耗时 6758ms
::1 - - [02/Sep/2025:06:02:51 +0000] "GET /api/employees HTTP/1.1" 200 2940 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 2ms
🚀 开始员工数据同步...
🔑 更新钉钉API凭证...
✅ API凭证已更新
👥 获取在职员工列表...
🔑 获取钉钉Access Token...
⏳ 获取待入职员工列表...
🔑 获取钉钉Access Token...
🚪 获取离职员工列表...
🔑 获取钉钉Access Token...
✅ Access Token获取成功，有效期: 7200 秒
📞 调用在职员工API，offset: 0
✅ Access Token获取成功，有效期: 7200 秒
📞 调用待入职员工API，offset: 0
✅ Access Token获取成功，有效期: 7200 秒
📞 调用离职员工API，次标记 nextToken: 0
📦 共收集到离职用户 2 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📦 共收集到在职用户 3 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📦 共收集到待入职用户 4 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
🧩 有 2 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 23565222083035276194,024408350460583974855
🧩 有 3 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 23565222091335276194,66292386,manager918
🧯 仍有 2 个用户缺少部门ID，尝试通过用户详情API补充...
🔍 开始获取用户详情: 23565222083035276194
🔍 开始获取用户详情: 024408350460583974855
🧩 有 4 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 285154521324305418,180266290129328565,204635094835703839,230267420826317752
📋 用户详情API响应 23565222083035276194: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15r8b1hum3vqg"
}
❌ 获取用户详情失败 23565222083035276194: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 23565222091335276194: 许测试 / 未知部门 (#MAYO Tset)
📝 解析员工数据 66292386: 张测试 / 未知部门 (#Buzz)
📝 解析员工数据 manager918: 大哥大 / 未知部门 (#Buzz)
✅ 获取到 3 名在职员工
📋 用户详情API响应 024408350460583974855: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15rk678y8ylfk"
}
❌ 获取用户详情失败 024408350460583974855: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 23565222083035276194: 许测试 / 未知部门 (#0)
📝 解析员工数据 024408350460583974855: 小筑设计助手 / 未知部门 (#0)
✅ 获取到 2 名离职员工
🧯 仍有 4 个用户缺少部门ID，尝试通过用户详情API补充...
🔍 开始获取用户详情: 285154521324305418
🔍 开始获取用户详情: 180266290129328565
🔍 开始获取用户详情: 204635094835703839
🔍 开始获取用户详情: 230267420826317752
📋 用户详情API响应 204635094835703839: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16kpyxic5t0zd"
}
❌ 获取用户详情失败 204635094835703839: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 230267420826317752: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15ruh8kek2u7m"
}
❌ 获取用户详情失败 230267420826317752: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 180266290129328565: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16mcs0smjifsl"
}
❌ 获取用户详情失败 180266290129328565: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 285154521324305418: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16mkhipzxrkhk"
}
❌ 获取用户详情失败 285154521324305418: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 285154521324305418: 张测试 / 未知部门 (#0)
📝 解析员工数据 180266290129328565: 王测试 / 未知部门 (#0)
📝 解析员工数据 204635094835703839: 赵测试 / 未知部门 (#0)
📝 解析员工数据 230267420826317752: 李测试 / 未知部门 (#0)
✅ 获取到 4 名待入职员工
📊 钉钉API数据获取完成: { active: 3, pending: 4, departed: 2 }
✅ 成功保存 9 条员工记录
🚀 开始导入数据到Apollo系统...
⚠️ Apollo数据库配置不完整，跳过实际导入
📤 模拟导入 9 条记录到Apollo系统
✅ 数据同步完成
::1 - - [02/Sep/2025:06:12:31 +0000] "POST /api/sync-employees HTTP/1.1" 200 992 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
POST /api/sync-employees - 200 - 5296ms
⚠️ 慢查询警告: /api/sync-employees 耗时 5296ms
::1 - - [02/Sep/2025:06:12:31 +0000] "GET /api/employees HTTP/1.1" 200 2940 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 3ms
::1 - - [02/Sep/2025:06:20:17 +0000] "GET /api/employees HTTP/1.1" 200 2940 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 15ms
::1 - - [02/Sep/2025:06:20:19 +0000] "GET /api/employees HTTP/1.1" 200 2940 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 3ms
🚀 开始员工数据同步...
🔑 更新钉钉API凭证...
✅ API凭证已更新
👥 获取在职员工列表...
🔑 获取钉钉Access Token...
⏳ 获取待入职员工列表...
🔑 获取钉钉Access Token...
🚪 获取离职员工列表...
🔑 获取钉钉Access Token...
✅ Access Token获取成功，有效期: 7200 秒
📞 调用在职员工API，offset: 0
✅ Access Token获取成功，有效期: 7200 秒
📞 调用离职员工API，次标记 nextToken: 0
✅ Access Token获取成功，有效期: 7200 秒
📞 调用待入职员工API，offset: 0
📦 共收集到离职用户 2 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📦 共收集到待入职用户 4 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📦 共收集到在职用户 3 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
🧩 有 2 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 23565222083035276194,024408350460583974855
🧩 有 3 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 23565222091335276194,66292386,manager918
🧯 仍有 2 个用户缺少部门ID，尝试通过用户详情API补充...
🔍 开始获取用户详情: 23565222083035276194
🔍 开始获取用户详情: 024408350460583974855
🧩 有 4 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 285154521324305418,180266290129328565,204635094835703839,230267420826317752
📋 用户详情API响应 23565222083035276194: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15r2xq869os2c"
}
❌ 获取用户详情失败 23565222083035276194: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 024408350460583974855: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16mdqbiety4d6"
}
❌ 获取用户详情失败 024408350460583974855: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 23565222083035276194: 许测试 / 未知部门 (#0)
📝 解析员工数据 024408350460583974855: 小筑设计助手 / 未知部门 (#0)
✅ 获取到 2 名离职员工
📝 解析员工数据 23565222091335276194: 许测试 / 未知部门 (#MAYO Tset)
📝 解析员工数据 66292386: 张测试 / 未知部门 (#Buzz)
📝 解析员工数据 manager918: 韦小宝 / 未知部门 (#Buzz)
✅ 获取到 3 名在职员工
🧯 仍有 4 个用户缺少部门ID，尝试通过用户详情API补充...
🔍 开始获取用户详情: 285154521324305418
🔍 开始获取用户详情: 180266290129328565
🔍 开始获取用户详情: 204635094835703839
🔍 开始获取用户详情: 230267420826317752
📋 用户详情API响应 180266290129328565: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15ru1nca4m7v0"
}
❌ 获取用户详情失败 180266290129328565: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 204635094835703839: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15rl7m7lvk9ce"
}
❌ 获取用户详情失败 204635094835703839: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 230267420826317752: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16mhpquei0yzb"
}
❌ 获取用户详情失败 230267420826317752: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 285154521324305418: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15ra7mx77l4xb"
}
❌ 获取用户详情失败 285154521324305418: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 285154521324305418: 张测试 / 未知部门 (#0)
📝 解析员工数据 180266290129328565: 王测试 / 未知部门 (#0)
📝 解析员工数据 204635094835703839: 赵测试 / 未知部门 (#0)
📝 解析员工数据 230267420826317752: 李测试 / 未知部门 (#0)
✅ 获取到 4 名待入职员工
📊 钉钉API数据获取完成: { active: 3, pending: 4, departed: 2 }
✅ 成功保存 9 条员工记录
🚀 开始导入数据到Apollo系统...
⚠️ Apollo数据库配置不完整，跳过实际导入
📤 模拟导入 9 条记录到Apollo系统
✅ 数据同步完成
::1 - - [02/Sep/2025:06:20:27 +0000] "POST /api/sync-employees HTTP/1.1" 200 992 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
POST /api/sync-employees - 200 - 6803ms
⚠️ 慢查询警告: /api/sync-employees 耗时 6803ms
::1 - - [02/Sep/2025:06:20:27 +0000] "GET /api/employees HTTP/1.1" 200 2940 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 2ms
🗑️ 开始清空员工数据...
✅ 员工数据已清空
::1 - - [02/Sep/2025:06:24:07 +0000] "DELETE /api/employees HTTP/1.1" 200 113 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
DELETE /api/employees - 200 - 9ms
🚀 开始员工数据同步...
🔑 更新钉钉API凭证...
✅ API凭证已更新
👥 获取在职员工列表...
🔑 获取钉钉Access Token...
⏳ 获取待入职员工列表...
🔑 获取钉钉Access Token...
🚪 获取离职员工列表...
🔑 获取钉钉Access Token...
✅ Access Token获取成功，有效期: 7200 秒
📞 调用在职员工API，offset: 0
✅ Access Token获取成功，有效期: 7200 秒
📞 调用离职员工API，次标记 nextToken: 0
✅ Access Token获取成功，有效期: 7200 秒
📞 调用待入职员工API，offset: 0
📦 共收集到离职用户 2 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📦 共收集到在职用户 3 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📦 共收集到待入职用户 4 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
🧩 有 3 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 23565222091335276194,66292386,manager918
🧩 有 2 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 23565222083035276194,024408350460583974855
🧩 有 4 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 285154521324305418,180266290129328565,204635094835703839,230267420826317752
📝 解析员工数据 23565222091335276194: 许测试 / 未知部门 (#MAYO Tset)
📝 解析员工数据 66292386: 张测试 / 未知部门 (#Buzz)
📝 解析员工数据 manager918: 韦小宝 / 未知部门 (#Buzz)
✅ 获取到 3 名在职员工
🧯 仍有 2 个用户缺少部门ID，尝试通过用户详情API补充...
🔍 开始获取用户详情: 23565222083035276194
🔍 开始获取用户详情: 024408350460583974855
📋 用户详情API响应 024408350460583974855: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15qv1zt64uzpb"
}
❌ 获取用户详情失败 024408350460583974855: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 23565222083035276194: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16khwyltgj90r"
}
❌ 获取用户详情失败 23565222083035276194: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 23565222083035276194: 许测试 / 未知部门 (#0)
📝 解析员工数据 024408350460583974855: 小筑设计助手 / 未知部门 (#0)
✅ 获取到 2 名离职员工
🧯 仍有 4 个用户缺少部门ID，尝试通过用户详情API补充...
🔍 开始获取用户详情: 285154521324305418
🔍 开始获取用户详情: 180266290129328565
🔍 开始获取用户详情: 204635094835703839
🔍 开始获取用户详情: 230267420826317752
📋 用户详情API响应 180266290129328565: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16mcfjth8zpo4"
}
❌ 获取用户详情失败 180266290129328565: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 285154521324305418: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15rfr6oy16p3o"
}
❌ 获取用户详情失败 285154521324305418: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 204635094835703839: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16kfbf7qkqht3"
}
❌ 获取用户详情失败 204635094835703839: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 230267420826317752: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16klt9oxtl71t"
}
❌ 获取用户详情失败 230267420826317752: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 285154521324305418: 张测试 / 未知部门 (#0)
📝 解析员工数据 180266290129328565: 王测试 / 未知部门 (#0)
📝 解析员工数据 204635094835703839: 赵测试 / 未知部门 (#0)
📝 解析员工数据 230267420826317752: 李测试 / 未知部门 (#0)
✅ 获取到 4 名待入职员工
📊 钉钉API数据获取完成: { active: 3, pending: 4, departed: 2 }
✅ 成功保存 9 条员工记录
🚀 开始导入数据到Apollo系统...
⚠️ Apollo数据库配置不完整，跳过实际导入
📤 模拟导入 9 条记录到Apollo系统
✅ 数据同步完成
::1 - - [02/Sep/2025:06:24:13 +0000] "POST /api/sync-employees HTTP/1.1" 200 992 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
POST /api/sync-employees - 200 - 4813ms
::1 - - [02/Sep/2025:06:24:13 +0000] "GET /api/employees HTTP/1.1" 200 2940 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 1ms
🚀 开始员工数据同步...
🔑 更新钉钉API凭证...
✅ API凭证已更新
👥 获取在职员工列表...
🔑 获取钉钉Access Token...
⏳ 获取待入职员工列表...
🔑 获取钉钉Access Token...
🚪 获取离职员工列表...
🔑 获取钉钉Access Token...
✅ Access Token获取成功，有效期: 7200 秒
📞 调用待入职员工API，offset: 0
✅ Access Token获取成功，有效期: 7200 秒
📞 调用离职员工API，次标记 nextToken: 0
✅ Access Token获取成功，有效期: 7200 秒
📞 调用在职员工API，offset: 0
📦 共收集到离职用户 2 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📦 共收集到待入职用户 4 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📦 共收集到在职用户 3 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
🧩 有 2 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 23565222083035276194,024408350460583974855
🧩 有 4 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 285154521324305418,180266290129328565,204635094835703839,230267420826317752
🧩 有 3 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 23565222091335276194,66292386,manager918
🧯 仍有 2 个用户缺少部门ID，尝试通过用户详情API补充...
🔍 开始获取用户详情: 23565222083035276194
🔍 开始获取用户详情: 024408350460583974855
📝 解析员工数据 23565222091335276194: 许测试 / 未知部门 (#MAYO Tset)
📝 解析员工数据 66292386: 张测试 / 未知部门 (#Buzz)
📝 解析员工数据 manager918: 韦小宝 / 未知部门 (#Buzz)
✅ 获取到 3 名在职员工
📋 用户详情API响应 23565222083035276194: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15rq5c9an2p7g"
}
❌ 获取用户详情失败 23565222083035276194: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 024408350460583974855: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16llbmpeftlli"
}
❌ 获取用户详情失败 024408350460583974855: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 23565222083035276194: 许测试 / 未知部门 (#0)
📝 解析员工数据 024408350460583974855: 小筑设计助手 / 未知部门 (#0)
✅ 获取到 2 名离职员工
🧯 仍有 4 个用户缺少部门ID，尝试通过用户详情API补充...
🔍 开始获取用户详情: 285154521324305418
🔍 开始获取用户详情: 180266290129328565
🔍 开始获取用户详情: 204635094835703839
🔍 开始获取用户详情: 230267420826317752
📋 用户详情API响应 285154521324305418: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15s2sk87yflqw"
}
❌ 获取用户详情失败 285154521324305418: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 180266290129328565: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15rez4h5e91h6"
}
❌ 获取用户详情失败 180266290129328565: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 204635094835703839: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16ko8klb5mpj0"
}
❌ 获取用户详情失败 204635094835703839: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 230267420826317752: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15qter4ojoeqp"
}
❌ 获取用户详情失败 230267420826317752: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 285154521324305418: 张测试 / 未知部门 (#0)
📝 解析员工数据 180266290129328565: 王测试 / 未知部门 (#0)
📝 解析员工数据 204635094835703839: 赵测试 / 未知部门 (#0)
📝 解析员工数据 230267420826317752: 李测试 / 未知部门 (#0)
✅ 获取到 4 名待入职员工
📊 钉钉API数据获取完成: { active: 3, pending: 4, departed: 2 }
✅ 成功保存 9 条员工记录
🚀 开始导入数据到Apollo系统...
⚠️ Apollo数据库配置不完整，跳过实际导入
❌ 数据同步失败: Error: Apollo系统临时不可用，请稍后重试
    at ApolloService.simulateApolloImport (/Users/willis_xu/Documents/DingPOC/dingtalk-apollo-poc/backend/services/apollo.js:161:13)
    at async /Users/willis_xu/Documents/DingPOC/dingtalk-apollo-poc/backend/app.js:93:26
::1 - - [02/Sep/2025:06:25:15 +0000] "POST /api/sync-employees HTTP/1.1" 500 143 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
POST /api/sync-employees - 500 - 4863ms
🗑️ 开始清空员工数据...
✅ 员工数据已清空
::1 - - [02/Sep/2025:06:25:20 +0000] "DELETE /api/employees HTTP/1.1" 200 113 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
DELETE /api/employees - 200 - 2ms
🚀 开始员工数据同步...
🔑 更新钉钉API凭证...
✅ API凭证已更新
👥 获取在职员工列表...
🔑 获取钉钉Access Token...
⏳ 获取待入职员工列表...
🔑 获取钉钉Access Token...
🚪 获取离职员工列表...
🔑 获取钉钉Access Token...
✅ Access Token获取成功，有效期: 7200 秒
📞 调用待入职员工API，offset: 0
✅ Access Token获取成功，有效期: 7200 秒
📞 调用在职员工API，offset: 0
✅ Access Token获取成功，有效期: 7200 秒
📞 调用离职员工API，次标记 nextToken: 0
📦 共收集到离职用户 2 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📦 共收集到待入职用户 4 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📦 共收集到在职用户 3 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
🧩 有 3 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 23565222091335276194,66292386,manager918
🧩 有 2 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 23565222083035276194,024408350460583974855
🧩 有 4 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 285154521324305418,180266290129328565,204635094835703839,230267420826317752
🧯 仍有 2 个用户缺少部门ID，尝试通过用户详情API补充...
🔍 开始获取用户详情: 23565222083035276194
🔍 开始获取用户详情: 024408350460583974855
📝 解析员工数据 23565222091335276194: 许测试 / 未知部门 (#MAYO Tset)
📝 解析员工数据 66292386: 张测试 / 未知部门 (#Buzz)
📝 解析员工数据 manager918: 韦小宝 / 未知部门 (#Buzz)
✅ 获取到 3 名在职员工
📋 用户详情API响应 23565222083035276194: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16l5tilsjfn26"
}
❌ 获取用户详情失败 23565222083035276194: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 024408350460583974855: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16mgxompvu25u"
}
❌ 获取用户详情失败 024408350460583974855: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 23565222083035276194: 许测试 / 未知部门 (#0)
📝 解析员工数据 024408350460583974855: 小筑设计助手 / 未知部门 (#0)
✅ 获取到 2 名离职员工
🧯 仍有 4 个用户缺少部门ID，尝试通过用户详情API补充...
🔍 开始获取用户详情: 285154521324305418
🔍 开始获取用户详情: 180266290129328565
🔍 开始获取用户详情: 204635094835703839
🔍 开始获取用户详情: 230267420826317752
📋 用户详情API响应 230267420826317752: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15qthvdk16p4w"
}
❌ 获取用户详情失败 230267420826317752: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 285154521324305418: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15rb2te18mnz5"
}
❌ 获取用户详情失败 285154521324305418: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 180266290129328565: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16mh0svl6vwzq"
}
❌ 获取用户详情失败 180266290129328565: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 204635094835703839: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16me5wqwejqop"
}
❌ 获取用户详情失败 204635094835703839: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 285154521324305418: 张测试 / 未知部门 (#0)
📝 解析员工数据 180266290129328565: 王测试 / 未知部门 (#0)
📝 解析员工数据 204635094835703839: 赵测试 / 未知部门 (#0)
📝 解析员工数据 230267420826317752: 李测试 / 未知部门 (#0)
✅ 获取到 4 名待入职员工
📊 钉钉API数据获取完成: { active: 3, pending: 4, departed: 2 }
✅ 成功保存 9 条员工记录
🚀 开始导入数据到Apollo系统...
⚠️ Apollo数据库配置不完整，跳过实际导入
📤 模拟导入 9 条记录到Apollo系统
✅ 数据同步完成
::1 - - [02/Sep/2025:06:25:27 +0000] "POST /api/sync-employees HTTP/1.1" 200 992 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
POST /api/sync-employees - 200 - 5166ms
⚠️ 慢查询警告: /api/sync-employees 耗时 5166ms
::1 - - [02/Sep/2025:06:25:27 +0000] "GET /api/employees HTTP/1.1" 200 2958 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 2ms
🚀 开始员工数据同步...
🔑 更新钉钉API凭证...
✅ API凭证已更新
👥 获取在职员工列表...
🔑 获取钉钉Access Token...
⏳ 获取待入职员工列表...
🔑 获取钉钉Access Token...
🚪 获取离职员工列表...
🔑 获取钉钉Access Token...
✅ Access Token获取成功，有效期: 7200 秒
📞 调用在职员工API，offset: 0
✅ Access Token获取成功，有效期: 7200 秒
📞 调用离职员工API，次标记 nextToken: 0
✅ Access Token获取成功，有效期: 7200 秒
📞 调用待入职员工API，offset: 0
📦 共收集到离职用户 2 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📦 共收集到待入职用户 4 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📦 共收集到在职用户 3 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
🧩 有 3 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 23565222091335276194,manager918,66292386
🧩 有 2 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 23565222083035276194,024408350460583974855
🧩 有 4 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 285154521324305418,180266290129328565,204635094835703839,230267420826317752
📝 解析员工数据 23565222091335276194: 许测试 / 未知部门 (#MAYO Tset)
📝 解析员工数据 manager918: 韦小宝 / 未知部门 (#Buzz)
📝 解析员工数据 66292386: 张测试 / 未知部门 (#Buzz)
✅ 获取到 3 名在职员工
🧯 仍有 2 个用户缺少部门ID，尝试通过用户详情API补充...
🔍 开始获取用户详情: 23565222083035276194
🔍 开始获取用户详情: 024408350460583974855
📋 用户详情API响应 23565222083035276194: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16mlftfximsz7"
}
❌ 获取用户详情失败 23565222083035276194: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 024408350460583974855: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15s43bx9snm83"
}
❌ 获取用户详情失败 024408350460583974855: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 23565222083035276194: 许测试 / 未知部门 (#0)
📝 解析员工数据 024408350460583974855: 小筑设计助手 / 未知部门 (#0)
✅ 获取到 2 名离职员工
🧯 仍有 4 个用户缺少部门ID，尝试通过用户详情API补充...
🔍 开始获取用户详情: 285154521324305418
🔍 开始获取用户详情: 180266290129328565
🔍 开始获取用户详情: 204635094835703839
🔍 开始获取用户详情: 230267420826317752
📋 用户详情API响应 285154521324305418: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16kxunxthe12z"
}
❌ 获取用户详情失败 285154521324305418: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 180266290129328565: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16l26k9ab8obl"
}
❌ 获取用户详情失败 180266290129328565: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 204635094835703839: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16mlixostv2qx"
}
❌ 获取用户详情失败 204635094835703839: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 230267420826317752: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15rmxz5538bfy"
}
❌ 获取用户详情失败 230267420826317752: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 285154521324305418: 张测试 / 未知部门 (#0)
📝 解析员工数据 180266290129328565: 王测试 / 未知部门 (#0)
📝 解析员工数据 204635094835703839: 赵测试 / 未知部门 (#0)
📝 解析员工数据 230267420826317752: 李测试 / 未知部门 (#0)
✅ 获取到 4 名待入职员工
📊 钉钉API数据获取完成: { active: 3, pending: 4, departed: 2 }
✅ 成功保存 9 条员工记录
🚀 开始导入数据到Apollo系统...
⚠️ Apollo数据库配置不完整，跳过实际导入
📤 模拟导入 9 条记录到Apollo系统
✅ 数据同步完成
::1 - - [02/Sep/2025:06:25:40 +0000] "POST /api/sync-employees HTTP/1.1" 200 992 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
POST /api/sync-employees - 200 - 5716ms
⚠️ 慢查询警告: /api/sync-employees 耗时 5716ms
::1 - - [02/Sep/2025:06:25:40 +0000] "GET /api/employees HTTP/1.1" 200 2958 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 1ms
🗑️ 开始清空员工数据...
✅ 员工数据已清空
::1 - - [02/Sep/2025:06:26:24 +0000] "DELETE /api/employees HTTP/1.1" 200 113 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
DELETE /api/employees - 200 - 5ms
🚀 开始员工数据同步...
🔑 更新钉钉API凭证...
✅ API凭证已更新
👥 获取在职员工列表...
🔑 获取钉钉Access Token...
⏳ 获取待入职员工列表...
🔑 获取钉钉Access Token...
🚪 获取离职员工列表...
🔑 获取钉钉Access Token...
✅ Access Token获取成功，有效期: 7200 秒
📞 调用待入职员工API，offset: 0
✅ Access Token获取成功，有效期: 7200 秒
📞 调用离职员工API，次标记 nextToken: 0
✅ Access Token获取成功，有效期: 7200 秒
📞 调用在职员工API，offset: 0
📦 共收集到离职用户 2 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📦 共收集到待入职用户 4 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📦 共收集到在职用户 3 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
🧩 有 3 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 23565222091335276194,66292386,manager918
🧩 有 2 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 23565222083035276194,024408350460583974855
🧩 有 4 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 285154521324305418,180266290129328565,204635094835703839,230267420826317752
📝 解析员工数据 23565222091335276194: 许测试 / 未知部门 (#MAYO Tset)
📝 解析员工数据 66292386: 张测试 / 未知部门 (#Buzz)
📝 解析员工数据 manager918: 韦小宝 / 未知部门 (#Buzz)
✅ 获取到 3 名在职员工
🧯 仍有 2 个用户缺少部门ID，尝试通过用户详情API补充...
🔍 开始获取用户详情: 23565222083035276194
🔍 开始获取用户详情: 024408350460583974855
📋 用户详情API响应 024408350460583974855: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16kr0ch5wg07p"
}
❌ 获取用户详情失败 024408350460583974855: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 23565222083035276194: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15rtftmd6h17p"
}
❌ 获取用户详情失败 23565222083035276194: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 23565222083035276194: 许测试 / 未知部门 (#0)
📝 解析员工数据 024408350460583974855: 小筑设计助手 / 未知部门 (#0)
✅ 获取到 2 名离职员工
🧯 仍有 4 个用户缺少部门ID，尝试通过用户详情API补充...
🔍 开始获取用户详情: 285154521324305418
🔍 开始获取用户详情: 180266290129328565
🔍 开始获取用户详情: 204635094835703839
🔍 开始获取用户详情: 230267420826317752
📋 用户详情API响应 204635094835703839: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15r6u1bgs5bc9"
}
❌ 获取用户详情失败 204635094835703839: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 285154521324305418: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16mlixotosig7"
}
❌ 获取用户详情失败 285154521324305418: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 180266290129328565: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16krj1ydowcz3"
}
❌ 获取用户详情失败 180266290129328565: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 230267420826317752: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16kk959cs3k0b"
}
❌ 获取用户详情失败 230267420826317752: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 285154521324305418: 张测试 / 未知部门 (#0)
📝 解析员工数据 180266290129328565: 王测试 / 未知部门 (#0)
📝 解析员工数据 204635094835703839: 赵测试 / 未知部门 (#0)
📝 解析员工数据 230267420826317752: 李测试 / 未知部门 (#0)
✅ 获取到 4 名待入职员工
📊 钉钉API数据获取完成: { active: 3, pending: 4, departed: 2 }
✅ 成功保存 9 条员工记录
🚀 开始导入数据到Apollo系统...
⚠️ Apollo数据库配置不完整，跳过实际导入
📤 模拟导入 9 条记录到Apollo系统
✅ 数据同步完成
::1 - - [02/Sep/2025:06:26:29 +0000] "POST /api/sync-employees HTTP/1.1" 200 992 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
POST /api/sync-employees - 200 - 4275ms
::1 - - [02/Sep/2025:06:26:29 +0000] "GET /api/employees HTTP/1.1" 200 2958 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 1ms
🗑️ 开始清空员工数据...
✅ 员工数据已清空
::1 - - [02/Sep/2025:08:37:29 +0000] "DELETE /api/employees HTTP/1.1" 200 113 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
DELETE /api/employees - 200 - 23ms
🚀 开始员工数据同步...
🔑 更新钉钉API凭证...
✅ API凭证已更新
👥 获取在职员工列表...
🔑 获取钉钉Access Token...
⏳ 获取待入职员工列表...
🔑 获取钉钉Access Token...
🚪 获取离职员工列表...
🔑 获取钉钉Access Token...
✅ Access Token获取成功，有效期: 7200 秒
📞 调用离职员工API，次标记 nextToken: 0
✅ Access Token获取成功，有效期: 7200 秒
📞 调用待入职员工API，offset: 0
✅ Access Token获取成功，有效期: 7200 秒
📞 调用在职员工API，offset: 0
📦 共收集到离职用户 2 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📦 共收集到在职用户 3 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📦 共收集到待入职用户 4 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
🧩 有 3 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 23565222091335276194,66292386,manager918
🧩 有 4 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 285154521324305418,180266290129328565,204635094835703839,230267420826317752
📝 解析员工数据 23565222091335276194: 许测试 / 未知部门 (#MAYO Tset)
📝 解析员工数据 66292386: 张测试 / 未知部门 (#Buzz)
📝 解析员工数据 manager918: 韦小宝 / 未知部门 (#Buzz)
✅ 获取到 3 名在职员工
🧩 有 2 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 23565222083035276194,024408350460583974855
🧯 仍有 2 个用户缺少部门ID，尝试通过用户详情API补充...
🔍 开始获取用户详情: 23565222083035276194
🔍 开始获取用户详情: 024408350460583974855
🧯 仍有 4 个用户缺少部门ID，尝试通过用户详情API补充...
🔍 开始获取用户详情: 285154521324305418
🔍 开始获取用户详情: 180266290129328565
🔍 开始获取用户详情: 204635094835703839
🔍 开始获取用户详情: 230267420826317752
📋 用户详情API响应 024408350460583974855: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15rdbvwdh049x"
}
❌ 获取用户详情失败 024408350460583974855: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 23565222083035276194: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15r6kookc7a0b"
}
❌ 获取用户详情失败 23565222083035276194: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 23565222083035276194: 许测试 / 未知部门 (#0)
📝 解析员工数据 024408350460583974855: 小筑设计助手 / 未知部门 (#0)
✅ 获取到 2 名离职员工
📋 用户详情API响应 285154521324305418: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16mm1n9qwzwpc"
}
❌ 获取用户详情失败 285154521324305418: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 230267420826317752: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15rsqvr49o6im"
}
❌ 获取用户详情失败 230267420826317752: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 204635094835703839: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15r2rhubakdil"
}
❌ 获取用户详情失败 204635094835703839: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 180266290129328565: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15r4o39ftgw18"
}
❌ 获取用户详情失败 180266290129328565: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 285154521324305418: 张测试 / 未知部门 (#0)
📝 解析员工数据 180266290129328565: 王测试 / 未知部门 (#0)
📝 解析员工数据 204635094835703839: 赵测试 / 未知部门 (#0)
📝 解析员工数据 230267420826317752: 李测试 / 未知部门 (#0)
✅ 获取到 4 名待入职员工
📊 钉钉API数据获取完成: { active: 3, pending: 4, departed: 2 }
✅ 成功保存 9 条员工记录
🚀 开始导入数据到Apollo系统...
⚠️ Apollo数据库配置不完整，跳过实际导入
📤 模拟导入 9 条记录到Apollo系统
✅ 数据同步完成
::1 - - [02/Sep/2025:08:37:50 +0000] "POST /api/sync-employees HTTP/1.1" 200 992 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
POST /api/sync-employees - 200 - 7235ms
⚠️ 慢查询警告: /api/sync-employees 耗时 7235ms
::1 - - [02/Sep/2025:08:37:50 +0000] "GET /api/employees HTTP/1.1" 200 2958 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 4ms
🗑️ 开始清空员工数据...
✅ 员工数据已清空
::1 - - [02/Sep/2025:09:08:17 +0000] "DELETE /api/employees HTTP/1.1" 200 113 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
DELETE /api/employees - 200 - 56ms
🚀 开始员工数据同步...
🔑 更新钉钉API凭证...
✅ API凭证已更新
👥 获取在职员工列表...
🔑 获取钉钉Access Token...
⏳ 获取待入职员工列表...
🔑 获取钉钉Access Token...
🚪 获取离职员工列表...
🔑 获取钉钉Access Token...
✅ Access Token获取成功，有效期: 7200 秒
📞 调用待入职员工API，offset: 0
✅ Access Token获取成功，有效期: 7200 秒
📞 调用离职员工API，次标记 nextToken: 0
✅ Access Token获取成功，有效期: 7200 秒
📞 调用在职员工API，offset: 0
📦 共收集到离职用户 2 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📦 共收集到在职用户 3 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📦 共收集到待入职用户 4 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
🧩 有 2 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 23565222083035276194,024408350460583974855
🧩 有 3 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 23565222091335276194,manager918,66292386
🧯 仍有 2 个用户缺少部门ID，尝试通过用户详情API补充...
🔍 开始获取用户详情: 23565222083035276194
🔍 开始获取用户详情: 024408350460583974855
🧩 有 4 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 285154521324305418,180266290129328565,204635094835703839,230267420826317752
📋 用户详情API响应 23565222083035276194: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15rsnrj41moaj"
}
❌ 获取用户详情失败 23565222083035276194: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 23565222091335276194: 许测试 / 未知部门 (#MAYO Tset)
📝 解析员工数据 manager918: 韦小宝 / 未知部门 (#Buzz)
📝 解析员工数据 66292386: 张测试 / 未知部门 (#Buzz)
✅ 获取到 3 名在职员工
📋 用户详情API响应 024408350460583974855: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16lz3e08ee1im"
}
❌ 获取用户详情失败 024408350460583974855: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 23565222083035276194: 许测试 / 未知部门 (#0)
📝 解析员工数据 024408350460583974855: 小筑设计助手 / 未知部门 (#0)
✅ 获取到 2 名离职员工
🧯 仍有 4 个用户缺少部门ID，尝试通过用户详情API补充...
🔍 开始获取用户详情: 285154521324305418
🔍 开始获取用户详情: 180266290129328565
🔍 开始获取用户详情: 204635094835703839
🔍 开始获取用户详情: 230267420826317752
📋 用户详情API响应 285154521324305418: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16kwq4v41i1dp"
}
❌ 获取用户详情失败 285154521324305418: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 230267420826317752: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15r6kopfg3nrg"
}
❌ 获取用户详情失败 230267420826317752: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 204635094835703839: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15r5mdzv6ntvv"
}
❌ 获取用户详情失败 204635094835703839: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 180266290129328565: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16ml9l2scqxq1"
}
❌ 获取用户详情失败 180266290129328565: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 285154521324305418: 张测试 / 未知部门 (#0)
📝 解析员工数据 180266290129328565: 王测试 / 未知部门 (#0)
📝 解析员工数据 204635094835703839: 赵测试 / 未知部门 (#0)
📝 解析员工数据 230267420826317752: 李测试 / 未知部门 (#0)
✅ 获取到 4 名待入职员工
📊 钉钉API数据获取完成: { active: 3, pending: 4, departed: 2 }
✅ 成功保存 9 条员工记录
🚀 开始导入数据到Apollo系统...
⚠️ Apollo数据库配置不完整，跳过实际导入
📤 模拟导入 9 条记录到Apollo系统
✅ 数据同步完成
::1 - - [02/Sep/2025:09:08:26 +0000] "POST /api/sync-employees HTTP/1.1" 200 992 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
POST /api/sync-employees - 200 - 7401ms
⚠️ 慢查询警告: /api/sync-employees 耗时 7401ms
::1 - - [02/Sep/2025:09:08:26 +0000] "GET /api/employees HTTP/1.1" 200 2958 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 4ms
🗑️ 开始清空员工数据...
✅ 员工数据已清空
::1 - - [02/Sep/2025:09:08:40 +0000] "DELETE /api/employees HTTP/1.1" 200 113 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
DELETE /api/employees - 200 - 4ms
🚀 开始员工数据同步...
🔑 更新钉钉API凭证...
✅ API凭证已更新
👥 获取在职员工列表...
🔑 获取钉钉Access Token...
⏳ 获取待入职员工列表...
🔑 获取钉钉Access Token...
🚪 获取离职员工列表...
🔑 获取钉钉Access Token...
✅ Access Token获取成功，有效期: 7200 秒
📞 调用在职员工API，offset: 0
✅ Access Token获取成功，有效期: 7200 秒
📞 调用离职员工API，次标记 nextToken: 0
✅ Access Token获取成功，有效期: 7200 秒
📞 调用待入职员工API，offset: 0
📦 共收集到离职用户 2 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📦 共收集到在职用户 3 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📦 共收集到待入职用户 4 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
🧩 有 2 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 23565222083035276194,024408350460583974855
🧩 有 3 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 23565222091335276194,manager918,66292386
🧩 有 4 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 285154521324305418,180266290129328565,204635094835703839,230267420826317752
🧯 仍有 2 个用户缺少部门ID，尝试通过用户详情API补充...
🔍 开始获取用户详情: 23565222083035276194
🔍 开始获取用户详情: 024408350460583974855
📝 解析员工数据 23565222091335276194: 许测试 / 未知部门 (#MAYO Tset)
📝 解析员工数据 manager918: 韦小宝 / 未知部门 (#Buzz)
📝 解析员工数据 66292386: 张测试 / 未知部门 (#Buzz)
✅ 获取到 3 名在职员工
📋 用户详情API响应 23565222083035276194: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15qupiyc4ck7o"
}
❌ 获取用户详情失败 23565222083035276194: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 024408350460583974855: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15rorgg01daux"
}
❌ 获取用户详情失败 024408350460583974855: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 23565222083035276194: 许测试 / 未知部门 (#0)
📝 解析员工数据 024408350460583974855: 小筑设计助手 / 未知部门 (#0)
✅ 获取到 2 名离职员工
🧯 仍有 4 个用户缺少部门ID，尝试通过用户详情API补充...
🔍 开始获取用户详情: 285154521324305418
🔍 开始获取用户详情: 180266290129328565
🔍 开始获取用户详情: 204635094835703839
🔍 开始获取用户详情: 230267420826317752
📋 用户详情API响应 204635094835703839: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16keyycwktnjw"
}
❌ 获取用户详情失败 204635094835703839: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 285154521324305418: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16kgcuatbnojd"
}
❌ 获取用户详情失败 285154521324305418: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 180266290129328565: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15roukovd2qfa"
}
❌ 获取用户详情失败 180266290129328565: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 230267420826317752: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15rv66oc0i1zm"
}
❌ 获取用户详情失败 230267420826317752: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 285154521324305418: 张测试 / 未知部门 (#0)
📝 解析员工数据 180266290129328565: 王测试 / 未知部门 (#0)
📝 解析员工数据 204635094835703839: 赵测试 / 未知部门 (#0)
📝 解析员工数据 230267420826317752: 李测试 / 未知部门 (#0)
✅ 获取到 4 名待入职员工
📊 钉钉API数据获取完成: { active: 3, pending: 4, departed: 2 }
✅ 成功保存 9 条员工记录
🚀 开始导入数据到Apollo系统...
⚠️ Apollo数据库配置不完整，跳过实际导入
📤 模拟导入 9 条记录到Apollo系统
✅ 数据同步完成
::1 - - [02/Sep/2025:09:08:45 +0000] "POST /api/sync-employees HTTP/1.1" 200 992 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
POST /api/sync-employees - 200 - 4610ms
::1 - - [02/Sep/2025:09:08:45 +0000] "GET /api/employees HTTP/1.1" 200 2978 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 2ms
::1 - - [03/Sep/2025:10:12:47 +0000] "GET /report/html/html_000858_20250903_175909.html HTTP/1.1" 404 100 "-" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /report/html/html_000858_20250903_175909.html - 404 - 20ms
::1 - - [03/Sep/2025:10:12:48 +0000] "GET /favicon.ico HTTP/1.1" 404 67 "-" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /favicon.ico - 404 - 4ms
::1 - - [03/Sep/2025:10:44:45 +0000] "GET /report/html/html_000858_20250903_184400.html HTTP/1.1" 404 100 "-" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /report/html/html_000858_20250903_184400.html - 404 - 29ms
::1 - - [08/Sep/2025:05:36:37 +0000] "GET /favicon.ico HTTP/1.1" 404 67 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /favicon.ico - 404 - 15ms
🗑️ 开始清空员工数据...
✅ 员工数据已清空
::1 - - [08/Sep/2025:05:36:40 +0000] "DELETE /api/employees HTTP/1.1" 200 113 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
DELETE /api/employees - 200 - 22ms
🚀 开始员工数据同步...
🔑 更新钉钉API凭证...
✅ API凭证已更新
👥 获取在职员工列表...
🔑 获取钉钉Access Token...
⏳ 获取待入职员工列表...
🔑 获取钉钉Access Token...
🚪 获取离职员工列表...
🔑 获取钉钉Access Token...
✅ Access Token获取成功，有效期: 7200 秒
📞 调用离职员工API，次标记 nextToken: 0
✅ Access Token获取成功，有效期: 7200 秒
📞 调用待入职员工API，offset: 0
✅ Access Token获取成功，有效期: 7200 秒
📞 调用在职员工API，offset: 0
📦 共收集到离职用户 2 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📦 共收集到待入职用户 4 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
📦 共收集到在职用户 3 个，开始批量获取花名册信息（并发处理）
📦 计划执行花名册请求 1 个 (用户批次 1 × 字段批次 1)，并发 5
🧩 有 2 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 23565222083035276194,024408350460583974855
🧩 有 3 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 23565222091335276194,manager918,66292386
🧩 有 4 个用户缺失关键字段，使用旧版API补齐...
🔎 使用旧版花名册API补齐字段: 285154521324305418,180266290129328565,204635094835703839,230267420826317752
🧯 仍有 2 个用户缺少部门ID，尝试通过用户详情API补充...
🔍 开始获取用户详情: 23565222083035276194
🔍 开始获取用户详情: 024408350460583974855
📝 解析员工数据 23565222091335276194: 许测试 / 未知部门 (#MAYO Tset)
📝 解析员工数据 manager918: 韦小宝 / 未知部门 (#MAYO)
📝 解析员工数据 66292386: 张测试 / 未知部门 (#MAYO)
✅ 获取到 3 名在职员工
📋 用户详情API响应 23565222083035276194: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15rd2psisepf8"
}
❌ 获取用户详情失败 23565222083035276194: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 024408350460583974855: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16kcju2g1d7c0"
}
❌ 获取用户详情失败 024408350460583974855: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 23565222083035276194: 许测试 / 未知部门 (#0)
📝 解析员工数据 024408350460583974855: 小筑设计助手 / 未知部门 (#0)
✅ 获取到 2 名离职员工
🧯 仍有 4 个用户缺少部门ID，尝试通过用户详情API补充...
🔍 开始获取用户详情: 285154521324305418
🔍 开始获取用户详情: 180266290129328565
🔍 开始获取用户详情: 204635094835703839
🔍 开始获取用户详情: 230267420826317752
📋 用户详情API响应 230267420826317752: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16mhgkuff02wb"
}
❌ 获取用户详情失败 230267420826317752: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 180266290129328565: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16m72fa3trh4j"
}
❌ 获取用户详情失败 180266290129328565: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 204635094835703839: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "15rz8wv2q9505"
}
❌ 获取用户详情失败 204635094835703839: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📋 用户详情API响应 285154521324305418: {
  "errcode": 88,
  "sub_code": "60011",
  "sub_msg": "应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}",
  "errmsg": "ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]",
  "request_id": "16mgxvd7mxzsk"
}
❌ 获取用户详情失败 285154521324305418: 钉钉API错误: 88 - ding talk error[subcode=60011,submsg=应用尚未开通所需的权限：[qyapi_get_member]，点击链接申请并开通即可：https://open-dev.dingtalk.com/appscope/apply?content=dingb6n4wcejvpxajxey%23qyapi_get_member, {requiredScopes=[qyapi_get_member]}]
📝 解析员工数据 285154521324305418: 张测试 / 未知部门 (#0)
📝 解析员工数据 180266290129328565: 王测试 / 未知部门 (#0)
📝 解析员工数据 204635094835703839: 赵测试 / 未知部门 (#0)
📝 解析员工数据 230267420826317752: 李测试 / 未知部门 (#0)
✅ 获取到 4 名待入职员工
📊 钉钉API数据获取完成: { active: 3, pending: 4, departed: 2 }
✅ 成功保存 9 条员工记录
🚀 开始导入数据到Apollo系统...
⚠️ Apollo数据库配置不完整，跳过实际导入
📤 模拟导入 9 条记录到Apollo系统
✅ 数据同步完成
::1 - - [08/Sep/2025:05:36:48 +0000] "POST /api/sync-employees HTTP/1.1" 200 992 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
POST /api/sync-employees - 200 - 6858ms
⚠️ 慢查询警告: /api/sync-employees 耗时 6858ms
::1 - - [08/Sep/2025:05:36:48 +0000] "GET /api/employees HTTP/1.1" 200 2958 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/employees - 200 - 4ms
::1 - - [08/Sep/2025:05:52:04 +0000] "GET /api/data HTTP/1.1" 404 64 "-" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36"
GET /api/data - 404 - 5ms
[31m[nodemon] app crashed - waiting for file changes before starting...[39m
